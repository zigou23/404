import{j as n,B as N,T as y,b as J,G as li,I as Tr,u as Hr,d as je,C as Dr,e as ci,f as ui,g as kt,V as Ee,W as di,h as nn,L as qe,i as E,H as Ie,k as et,l as Fr,m as Pr,n as W,o as Kr,p as Fe,M as hi,q as fi,r as mi,s as pi,t as xi,F as G,v as yi,w as It,x as Et,A as Nr,y as tt,z as V,D as nt,E as rt,J as st,O as Ae,K,N as yn,P as Ct,Q as oe,R as zt,S as ae,U as gn,X as Br,Y as jn,Z as bn,$ as wn,a0 as ot,a1 as Ur,a2 as gi,a3 as Wr,a4 as Ot,a5 as Gr,a6 as ji,a7 as bi,a8 as at,a9 as Qr,aa as wi,ab as vi,ac as _i,ad as ki,ae as un,af as dn,ag as Si}from"./chakra-6b686174.js";import{a as Mi,u as vn,e as _n,f as qi,h as Vr,i as Ai,r as le,j as Ii,k as Ei,l as Ci,P as zi,b as Oi}from"./reacts-f889ea02.js";import{G as Y,U as Ri,E as $r,I as Jr}from"./icons-cbb2b13a.js";import{n as ge,o as Li,S as At,d as Ti,p as Hi,a as Di,b as Fi}from"./utility-3c87f33b.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))d(p);new MutationObserver(p=>{for(const s of p)if(s.type==="childList")for(const j of s.addedNodes)j.tagName==="LINK"&&j.rel==="modulepreload"&&d(j)}).observe(document,{childList:!0,subtree:!0});function c(p){const s={};return p.integrity&&(s.integrity=p.integrity),p.referrerPolicy&&(s.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?s.credentials="include":p.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(p){if(p.ep)return;p.ep=!0;const s=c(p);fetch(p.href,s)}})();var hn={},br=Mi;hn.createRoot=br.createRoot,hn.hydrateRoot=br.hydrateRoot;function Yr(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}}]})(o)}function Xr(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}}]})(o)}function Pi(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}}]})(o)}function Ki(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"}}]})(o)}function Ni(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"}}]})(o)}function Zr(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M12.65 10A5.99 5.99 0 007 6c-3.31 0-6 2.69-6 6s2.69 6 6 6a5.99 5.99 0 005.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"}}]})(o)}function es(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}}]})(o)}function kn(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}}]})(o)}function Rt(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}}]})(o)}function Bi(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}}]})(o)}function Ui(o){return Y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"}},{tag:"path",attr:{d:"M14 12c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2zm-2-9a9 9 0 00-9 9H0l4 4 4-4H5c0-3.87 3.13-7 7-7s7 3.13 7 7a6.995 6.995 0 01-11.06 5.7l-1.42 1.44A9 9 0 1012 3z"}}]})(o)}const ct=vn,ts=_n;var ns=(o=>(o.UNSUPPORTED_FILE="UNSUPPORTED_FILE",o.UNKNOWN="UNKNOWN",o))(ns||{});class Wi{constructor(l){this.worker=l,l.addEventListener("message",this.eventHandler)}idPromiseMap=new Map;eventHandler=l=>{const{id:c,result:d,error:p}=l.data,s=this.idPromiseMap.get(c);if(!s){console.error("cound not fetch worker promise for action: %s",c);return}this.idPromiseMap.delete(c);const[j,S]=s;if(p){const b=new Error(p.message,{cause:p});b.stack=p.stack,Object.assign(b,{code:p.code??null}),S(b)}else j(d)};async request(l,c){return new Promise((d,p)=>{const s=`request://${l}/${ge()}`;this.idPromiseMap.set(s,[d,p]),this.worker.postMessage({id:s,action:l,payload:c})})}}var Sn=(o=>(o.DECRYPT="DECRYPT",o.VERSION="VERSION",o))(Sn||{});const Gi=typeof setImmediate<"u"?setImmediate:typeof requestAnimationFrame<"u"?requestAnimationFrame:setTimeout;async function Qi(){return new Promise(o=>Gi(o))}class Vi{constructor(l=5){this.maxConcurrent=l}items=[];async add(l,c){return new Promise((d,p)=>{this.items.push([l,d,p,c]),this.runWorkerIfFree()})}runWorkerIfFree(){this.maxConcurrent>0&&(this.maxConcurrent--,this.processQueue().catch(l=>{console.error("process queue with error, continue.",l)}).finally(()=>{this.maxConcurrent++}))}async processQueue(){let l;for(;l=this.items.shift();){const[c,d,p,s]=l;try{s?.(),d(await this.handler(c))}catch(j){p(j)}finally{await Qi()}}}}class $i extends Vi{constructor(l,c){super(c),this.workerClientBus=l}async handler(l){return this.workerClientBus.request(Sn.DECRYPT,l)}}const rs=new Worker(new URL(""+new URL("worker-791f2612.js",import.meta.url).href,self.location),{type:"module"});rs.addEventListener("error",console.error);const ss=new Wi(rs),Ji=new $i(ss),Yi=new TextEncoder,Xi=new TextDecoder("utf-8");function wr(o){return Yi.encode(o)}function fn(o){return Xi.decode(o)}function Zi(o){const l=o.byteLength;for(let c=0;c<l;c++)if(o[c]===0)return c;return l}function eo(o){const l=o.buffer.slice(o.byteOffset,o.byteOffset+16);if(fn(l)!=="yeelion-kuwo-tme")return null;const c=new Uint8Array(o.buffer.slice(o.byteOffset+48,o.byteOffset+64)),d=Zi(c),p=fn(c.slice(0,d));return{encVersion:o.getUint32(16,!0),rid:o.getUint32(24,!0).toString(),quality:p}}function vr(o,l){if(o===l)return 0;if(o.length===0)return l.length;if(l.length===0)return o.length;const c=wr(o.normalize().toLowerCase()),d=wr(l.normalize().toLowerCase()),p=c.byteLength,s=d.byteLength;let j=new Uint32Array(s+1),S=new Uint32Array(s+1);for(let b=0;b<=s;b++)j[b]=b;for(let b=0;b<p;b++){S[0]=b+1;for(let M=0;M<s;M++){const A=j[M+1]+1,C=S[M]+1,R=j[M]+(c[b]===d[M]?0:1);S[M+1]=Math.min(A,C,R)}[j,S]=[S,j]}return j[s]}function to(o,l){const c=l.length;if(c===0)throw new Error("empty candidates");let d=0,p=vr(o,l[0]);for(let s=1;s<c;s++){const j=vr(o,l[s]);j<p&&(p=j,d=s)}return l[d]}function*_r(o){if(o&&typeof o=="object")for(const l in o)yield[l,o[l]]}const{hasOwn:is}=Object;function kr(o,l){const c=[];for(const[d,p]of Object.entries(o)){const s=l(d,p);s&&c.push(s)}return c}function Sr(o,l,c){return Li(o,l,c)}const no=o=>o.name.normalize(),ro=o=>o.ekey.trim(),so=(o,l)=>({id:ge(),name:o.normalize(),ekey:l.trim()}),os=o=>{const l=o.match(/^(\d+)-(\w+)$/);if(!l)return null;const[c,d,p]=l;return{rid:d,quality:p}},as=o=>`${o.rid}-${o.quality}`,io=o=>o.ekey,oo=(o,l)=>{if(typeof l!="string")return null;const c=os(o);return c?{id:ge(),rid:c.rid,quality:c.quality,ekey:l}:null},ao=o=>o.settings.dirty,lo=o=>o.settings.staging.qmc2,co=o=>o.settings.production.qmc2,uo=o=>o.settings.staging.kwm2.keys,ho=o=>o.settings.production.kwm2.keys,fo=(o,l)=>{const c=l.normalize();let d;const{keys:p,allowFuzzyNameSearch:s}=co(o);if(is(p,c))d=p[c];else if(s){const j=Object.keys(p);if(j.length>0){const S=to(c,j);console.debug("qmc2: key db could not find %o, using closest %o instead.",c,S),d=p[S]}}return d},mo=(o,l)=>{const c=eo(l);if(!c)return;const d=ho(o),p=as({id:"",ekey:"",quality:c.quality,rid:c.rid});let s;return is(d,p)&&(s=d[p]),s};var mn=(o=>(o.QUEUED="QUEUED",o.PROCESSING="PROCESSING",o.COMPLETE="COMPLETE",o.ERROR="ERROR",o))(mn||{});const po={files:Object.create(null),displayMode:"LIST"},pn=qi("fileListing/processFile",async({fileId:o},l)=>{const c=l.getState(),d=cs(c)[o];if(!d){const{message:S,stack:b}=new Error("ERROR: File not found");return l.rejectWithValue({message:S,stack:b})}const p=()=>{l.dispatch(yo({id:o}))},s=await fetch(d.raw,{headers:{Range:"bytes=0-1023"}}).then(S=>S.blob()).then(S=>S.arrayBuffer()),j={qmc2Key:fo(c,d.fileName),kwm2key:mo(c,new DataView(s))};return Ji.add({id:o,blobURI:d.raw,options:j},p)}),ls=Vr({name:"fileListing",initialState:po,reducers:{addNewFile:(o,{payload:l})=>{o.files[l.id]={fileName:l.fileName,raw:l.blobURI,decrypted:"",ext:"",state:"QUEUED",errorMessage:null,errorCode:null,metadata:null}},setDecryptedContent:(o,{payload:l})=>{const c=o.files[l.id];c&&(c.decrypted=l.decryptedBlobURI)},setFileAsProcessing:(o,{payload:l})=>{const c=o.files[l.id];c&&(c.state="PROCESSING")},deleteFile:(o,{payload:l})=>{if(o.files[l.id]){const c=o.files[l.id];c.decrypted&&URL.revokeObjectURL(c.decrypted),c.raw&&URL.revokeObjectURL(c.raw),delete o.files[l.id]}}},extraReducers(o){o.addCase(pn.fulfilled,(l,c)=>{const{fileId:d}=c.meta.arg,p=l.files[d];p&&(p.state="COMPLETE",p.decrypted=c.payload.decrypted,p.ext=c.payload.ext)}),o.addCase(pn.rejected,(l,c)=>{const{fileId:d}=c.meta.arg,p=l.files[d];p&&(p.errorMessage=c.error.message??"unknown error",p.errorCode=c.error.code??null,p.state="ERROR")})}}),{addNewFile:xo,setFileAsProcessing:yo,setDecryptedContent:Pa,deleteFile:go}=ls.actions,cs=o=>o.fileListing.files,jo=ls.reducer;function us({children:o,onReceiveFiles:l}){const{getRootProps:c,getInputProps:d,isDragActive:p}=Ai({multiple:!0,onDropAccepted:l});return n.jsxs(N,{...c(),w:"100%",maxW:480,borderWidth:"1px",borderRadius:"lg",transitionDuration:"0.5s",p:"6",cursor:"pointer",display:"flex",flexDir:"column",alignItems:"center",_hover:{borderColor:"gray.400",bg:"gray.50"},...p&&{bg:"blue.50",borderColor:"blue.700"},children:[n.jsx("input",{...d()}),o]})}function bo(){const o=ct(),l=c=>{console.debug("react-dropzone/onDropAccepted(%o, %o)",c.length,c.map(d=>d.name));for(const d of c){const p=URL.createObjectURL(d),s=d.name,j="file://"+ge();o(xo({id:j,blobURI:p,fileName:s})),o(pn({fileId:j}))}};return n.jsxs(us,{multiple:!0,onReceiveFiles:l,children:[n.jsx(N,{pb:3,children:n.jsx(Ri,{boxSize:8})}),n.jsxs(y,{as:"div",textAlign:"center",children:["拖放或",n.jsx(y,{as:"span",color:"teal.400",children:"点我选择"}),"需要解密的文件",n.jsx(y,{fontSize:"sm",opacity:"50%",children:"在浏览器内对文件进行解锁，零上传"})]})]})}const wo=J(li,{baseStyle:{gridTemplateAreas:{base:`
        "cover"
        "title"
        "meta"
        "action"
      `,md:`
        "cover title action"
        "cover meta  action"
      `},gridTemplateRows:{base:"repeat(auto-fill)",md:"min-content 1fr"},gridTemplateColumns:{base:"1fr",md:"160px 1fr"},gap:3}}),vo=""+new URL("no-cover-81648e65.svg",import.meta.url).href;function _o({name:o,url:l}){const c=o?`${o} 的专辑封面`:"专辑封面";return n.jsx(N,{w:"160px",h:"160px",m:"auto",children:n.jsx(Tr,{border:"2px solid",borderColor:"gray.400",borderRadius:"50%",objectFit:"cover",src:l||vo,alt:c})})}function ko({metadata:o}){return n.jsxs(N,{children:[n.jsxs(y,{children:["专辑: ",n.jsx("span",{"data-testid":"audio-meta-album-name",children:o.album})]}),n.jsxs(y,{children:["艺术家: ",n.jsx("span",{"data-testid":"audio-meta-song-artist",children:o.artist})]}),n.jsxs(y,{children:["专辑艺术家: ",n.jsx("span",{"data-testid":"audio-meta-album-artist",children:o.albumArtist})]})]})}const So=new Map([[ns.UNSUPPORTED_FILE,"尚未支持的文件格式"]]);function Mo({error:o,code:l}){const{isOpen:c,onToggle:d}=Hr(),p=So.get(l)??"未知错误";return n.jsxs(N,{children:[n.jsxs(y,{children:[n.jsxs(J.span,{children:["解密错误：",n.jsx(J.span,{color:"red.700",children:p})]}),o&&n.jsx(je,{ml:"2",onClick:d,type:"button",children:"详细"})]}),o&&n.jsx(Dr,{in:c,animateOpacity:!0,children:n.jsx(N,{as:"pre",display:"inline-block",mt:"2",px:"4",py:"2",bg:"red.100",color:"red.800",rounded:"md",children:o})})]})}function qo({id:o,file:l}){const{isOpen:c,onClose:d}=Hr({defaultIsOpen:!0}),p=ct(),s=l.state===mn.COMPLETE,j=l.metadata,S=l.fileName.replace(/\.[a-z\d]{3,6}$/,""),b=S+"."+l.ext,M=le.useRef(null),A=()=>{const R=M.current;R&&(R.paused?R.play():R.pause())},C=R=>{R==="exit"&&p(go({id:o}))};return n.jsx(Dr,{in:c,animateOpacity:!0,unmountOnExit:!0,startingHeight:0,onAnimationComplete:C,style:{width:"100%",padding:"0.25rem"},children:n.jsx(ci,{w:"full","data-testid":"file-row",children:n.jsx(ui,{children:n.jsxs(wo,{children:[n.jsx(kt,{area:"cover",children:n.jsx(_o,{name:j?.album,url:j?.cover})}),n.jsx(kt,{area:"title",children:n.jsx(N,{w:"full",as:"h4",fontWeight:"semibold",mt:"1",textAlign:{base:"center",md:"left"},children:n.jsx("span",{"data-testid":"audio-meta-song-name",children:j?.name??S})})}),n.jsxs(kt,{area:"meta",children:[s&&j&&n.jsx(ko,{metadata:j}),l.state===mn.ERROR&&n.jsx(Mo,{error:l.errorMessage,code:l.errorCode})]}),n.jsx(kt,{area:"action",alignSelf:"center",children:n.jsxs(Ee,{children:[l.decrypted&&n.jsx("audio",{controls:!0,autoPlay:!1,src:l.decrypted,ref:M}),n.jsxs(di,{children:[s&&n.jsxs(n.Fragment,{children:[n.jsx(nn,{children:n.jsx(je,{type:"button",onClick:A,children:"播放/暂停"})}),n.jsx(nn,{children:l.decrypted&&n.jsx(qe,{isExternal:!0,href:l.decrypted,download:b,children:n.jsx(je,{as:"span",children:"下载"})})})]}),n.jsx(nn,{children:n.jsx(je,{type:"button",onClick:d,children:"删除"})})]})]})})]})})})})}function Ao(){const o=ts(cs);return n.jsx(Ee,{children:Object.entries(o).map(([l,c])=>n.jsx(qo,{id:l,file:c},l))})}function Io(){return n.jsx(N,{h:"full",w:"full",pt:"4",children:n.jsxs(Ee,{gap:"3",children:[n.jsx(bo,{}),n.jsx(N,{w:"full",children:n.jsx(Ao,{})})]})})}const Mr={dirty:!1,staging:{qmc2:{allowFuzzyNameSearch:!0,keys:[]},kwm2:{keys:[]}},production:{qmc2:{allowFuzzyNameSearch:!0,keys:{}},kwm2:{keys:{}}}},Eo=o=>({qmc2:{keys:Sr(o.qmc2.keys,no,ro),allowFuzzyNameSearch:o.qmc2.allowFuzzyNameSearch},kwm2:{keys:Sr(o.kwm2.keys,as,io)}}),rn=o=>({qmc2:{keys:kr(o.qmc2.keys,so),allowFuzzyNameSearch:o.qmc2.allowFuzzyNameSearch},kwm2:{keys:kr(o.kwm2.keys,oo)}}),Mn=Vr({name:"settings",initialState:Mr,reducers:{setProductionChanges:(o,{payload:l})=>({dirty:!1,production:l,staging:rn(l)}),qmc2AddKey(o){o.staging.qmc2.keys.push({id:ge(),name:"",ekey:""}),o.dirty=!0},qmc2ImportKeys(o,{payload:l}){const c=l.map(d=>({id:ge(),...d}));o.staging.qmc2.keys.push(...c),o.dirty=!0},qmc2DeleteKey(o,{payload:{id:l}}){const c=o.staging.qmc2;c.keys=c.keys.filter(d=>d.id!==l),o.dirty=!0},qmc2UpdateKey(o,{payload:{id:l,field:c,value:d}}){const p=o.staging.qmc2.keys.find(s=>s.id===l);p&&(p[c]=d,o.dirty=!0)},qmc2ClearKeys(o){o.staging.qmc2.keys=[],o.dirty=!0},qmc2AllowFuzzyNameSearch(o,{payload:{enable:l}}){o.staging.qmc2.allowFuzzyNameSearch=l,o.dirty=!0},kwm2AddKey(o){o.staging.kwm2.keys.push({id:ge(),ekey:"",quality:"",rid:""}),o.dirty=!0},kwm2ImportKeys(o,{payload:l}){const c=l.map(d=>({id:ge(),...d}));o.staging.kwm2.keys.push(...c),o.dirty=!0},kwm2DeleteKey(o,{payload:{id:l}}){const c=o.staging.kwm2;c.keys=c.keys.filter(d=>d.id!==l),o.dirty=!0},kwm2UpdateKey(o,{payload:{id:l,field:c,value:d}}){const p=o.staging.kwm2.keys.find(s=>s.id===l);p&&(p[c]=d,o.dirty=!0)},kwm2ClearKeys(o){o.staging.kwm2.keys=[],o.dirty=!0},discardStagingChanges:o=>{o.dirty=!1,o.staging=rn(o.production)},commitStagingChange:o=>{const l=Eo(o.staging);return{dirty:!1,staging:rn(l),production:l}},resetConfig:()=>Mr}}),{setProductionChanges:Co,resetConfig:Ka,qmc2AddKey:zo,qmc2UpdateKey:Oo,qmc2DeleteKey:Ro,qmc2ClearKeys:Lo,qmc2ImportKeys:To,qmc2AllowFuzzyNameSearch:Ho,kwm2AddKey:Do,kwm2UpdateKey:Fo,kwm2DeleteKey:Po,kwm2ClearKeys:Ko,kwm2ImportKeys:No,commitStagingChange:Bo,discardStagingChanges:Uo}=Mn.actions,Wo=Mn.reducer,Go=le.memo(({id:o,name:l,ekey:c,i:d})=>{const p=ct(),s=(S,b)=>p(Oo({id:o,field:S,value:b.target.value})),j=()=>p(Ro({id:o}));return n.jsx(E,{mt:0,pt:2,pb:2,_even:{bg:"gray.50"},children:n.jsxs(Ie,{children:[n.jsx(y,{w:"2em",textAlign:"center",children:d+1}),n.jsxs(Ee,{flex:1,children:[n.jsx(et,{variant:"flushed",placeholder:"文件名，包括后缀名。如 “AAA - BBB.mflac”",value:l,onChange:S=>s("name",S)}),n.jsxs(Fr,{size:"xs",children:[n.jsx(Pr,{pr:"2",children:n.jsx(W,{as:Zr})}),n.jsx(et,{variant:"flushed",placeholder:"密钥，通常包含 364 或 704 位字符，没有空格。",value:c,onChange:S=>s("ekey",S)}),n.jsx(Kr,{children:n.jsx(y,{pl:"2",color:c.length?"green.500":"red.500",children:n.jsx("code",{children:c.length||"?"})})})]})]}),n.jsx(Fe,{"aria-label":"删除该密钥",icon:n.jsx(W,{as:Xr,boxSize:6}),variant:"ghost",colorScheme:"red",type:"button",onClick:j})]})})});function ds({clientName:o,children:l,show:c,onClose:d,onImport:p}){const s=j=>p(j[0]);return n.jsxs(hi,{isOpen:c,onClose:d,closeOnOverlayClick:!1,scrollBehavior:"inside",size:"xl",children:[n.jsx(fi,{}),n.jsxs(mi,{children:[n.jsx(pi,{children:"从文件导入密钥"}),n.jsx(xi,{}),n.jsxs(G,{as:yi,gap:2,flexDir:"column",flex:1,children:[n.jsx(It,{children:n.jsx(us,{onReceiveFiles:s,children:"拖放或点我选择含有密钥的数据库文件"})}),n.jsxs(y,{mt:2,children:["选择你的",o&&n.jsxs(n.Fragment,{children:["「",o,"」"]}),"客户端平台以查看对应说明："]}),n.jsx(G,{as:Et,variant:"enclosed",flexDir:"column",flex:1,minH:0,children:l})]})]})]})}function hs(o){return o.replace(/.*[\\/]/,"")}var St=void 0,Ze=function(o){return St||(St=new Promise(function(l,c){var d=typeof o<"u"?o:{},p=d.onAbort;d.onAbort=function(e){c(new Error(e)),p&&p(e)},d.postRun=d.postRun||[],d.postRun.push(function(){l(d)}),He=void 0;var s;s||(s=typeof d<"u"?d:{}),s.onRuntimeInitialized=function(){function e(u,x){switch(typeof x){case"boolean":ii(u,x?1:0);break;case"number":ni(u,x);break;case"string":ri(u,x,-1,-1);break;case"object":if(x===null)gr(u);else if(x.length!=null){var g=tn(x);si(u,g,x.length,-1),wt(g)}else _t(u,"Wrong API use : tried to return a value of an unknown type ("+x+").",-1);break;default:gr(u)}}function t(u,x){for(var g=[],w=0;w<u;w+=1){var I=ce(x+4*w,"i32"),L=Ys(I);if(L===1||L===2)I=ti(I);else if(L===3)I=Zs(I);else if(L===4){L=I,I=Xs(L),L=ei(L);for(var ie=new Uint8Array(I),$=0;$<I;$+=1)ie[$]=B[L+$];I=ie}else I=null;g.push(I)}return g}function r(u,x){this.La=u,this.db=x,this.Ja=1,this.fb=[]}function i(u,x){if(this.db=x,x=Oe(u)+1,this.Ya=bt(x),this.Ya===null)throw Error("Unable to allocate memory for the SQL string");ve(u,re,this.Ya,x),this.eb=this.Ya,this.Ua=this.ib=null}function a(u){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),u!=null){var x=this.filename,g="/",w=x;if(g&&(g=typeof g=="string"?g:Ue(g),w=x?ue(g+"/"+x):g),x=ir(!0,!0),w=ft(w,(x!==void 0?x:438)&4095|32768,0),u){if(typeof u=="string"){g=Array(u.length);for(var I=0,L=u.length;I<L;++I)g[I]=u.charCodeAt(I);u=g}pt(w,x|146),g=Le(w,577),nr(g,u,0,u.length,0),Qt(g),pt(w,x)}}this.handleError(_(this.filename,h)),this.db=ce(h,"i32"),oi(this.db),this.Za={},this.Na={}}var h=ye(4),f=s.cwrap,_=f("sqlite3_open","number",["string","number"]),O=f("sqlite3_close_v2","number",["number"]),z=f("sqlite3_exec","number",["number","string","number","number","number"]),P=f("sqlite3_changes","number",["number"]),de=f("sqlite3_prepare_v2","number",["number","string","number","number","number"]),fr=f("sqlite3_sql","string",["number"]),Rs=f("sqlite3_normalized_sql","string",["number"]),mr=f("sqlite3_prepare_v2","number",["number","number","number","number","number"]),Ls=f("sqlite3_bind_text","number",["number","number","number","number","number"]),pr=f("sqlite3_bind_blob","number",["number","number","number","number","number"]),Ts=f("sqlite3_bind_double","number",["number","number","number"]),Hs=f("sqlite3_bind_int","number",["number","number","number"]),Ds=f("sqlite3_bind_parameter_index","number",["number","string"]),Fs=f("sqlite3_step","number",["number"]),Ps=f("sqlite3_errmsg","string",["number"]),Ks=f("sqlite3_column_count","number",["number"]),Ns=f("sqlite3_data_count","number",["number"]),Bs=f("sqlite3_column_double","number",["number","number"]),xr=f("sqlite3_column_text","string",["number","number"]),Us=f("sqlite3_column_blob","number",["number","number"]),Ws=f("sqlite3_column_bytes","number",["number","number"]),Gs=f("sqlite3_column_type","number",["number","number"]),Qs=f("sqlite3_column_name","string",["number","number"]),Vs=f("sqlite3_reset","number",["number"]),$s=f("sqlite3_clear_bindings","number",["number"]),Js=f("sqlite3_finalize","number",["number"]),yr=f("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),Ys=f("sqlite3_value_type","number",["number"]),Xs=f("sqlite3_value_bytes","number",["number"]),Zs=f("sqlite3_value_text","string",["number"]),ei=f("sqlite3_value_blob","number",["number"]),ti=f("sqlite3_value_double","number",["number"]),ni=f("sqlite3_result_double","",["number","number"]),gr=f("sqlite3_result_null","",["number"]),ri=f("sqlite3_result_text","",["number","string","number","number"]),si=f("sqlite3_result_blob","",["number","number","number","number"]),ii=f("sqlite3_result_int","",["number","number"]),_t=f("sqlite3_result_error","",["number","string","number"]),jr=f("sqlite3_aggregate_context","number",["number","number"]),oi=f("RegisterExtensionFunctions","number",["number"]);r.prototype.bind=function(u){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(u)?this.xb(u):u!=null&&typeof u=="object"?this.yb(u):!0},r.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var u=Fs(this.La);switch(u){case 100:return!0;case 101:return!1;default:throw this.db.handleError(u)}},r.prototype.sb=function(u){return u==null&&(u=this.Ja,this.Ja+=1),Bs(this.La,u)},r.prototype.Cb=function(u){if(u==null&&(u=this.Ja,this.Ja+=1),u=xr(this.La,u),typeof BigInt!="function")throw Error("BigInt is not supported");return BigInt(u)},r.prototype.Db=function(u){return u==null&&(u=this.Ja,this.Ja+=1),xr(this.La,u)},r.prototype.getBlob=function(u){u==null&&(u=this.Ja,this.Ja+=1);var x=Ws(this.La,u);u=Us(this.La,u);for(var g=new Uint8Array(x),w=0;w<x;w+=1)g[w]=B[u+w];return g},r.prototype.get=function(u,x){x=x||{},u!=null&&this.bind(u)&&this.step(),u=[];for(var g=Ns(this.La),w=0;w<g;w+=1)switch(Gs(this.La,w)){case 1:var I=x.useBigInt?this.Cb(w):this.sb(w);u.push(I);break;case 2:u.push(this.sb(w));break;case 3:u.push(this.Db(w));break;case 4:u.push(this.getBlob(w));break;default:u.push(null)}return u},r.prototype.getColumnNames=function(){for(var u=[],x=Ks(this.La),g=0;g<x;g+=1)u.push(Qs(this.La,g));return u},r.prototype.getAsObject=function(u,x){u=this.get(u,x),x=this.getColumnNames();for(var g={},w=0;w<x.length;w+=1)g[x[w]]=u[w];return g},r.prototype.getSQL=function(){return fr(this.La)},r.prototype.getNormalizedSQL=function(){return Rs(this.La)},r.prototype.run=function(u){return u!=null&&this.bind(u),this.step(),this.reset()},r.prototype.nb=function(u,x){x==null&&(x=this.Ja,this.Ja+=1),u=Hn(u);var g=tn(u);this.fb.push(g),this.db.handleError(Ls(this.La,x,g,u.length-1,0))},r.prototype.wb=function(u,x){x==null&&(x=this.Ja,this.Ja+=1);var g=tn(u);this.fb.push(g),this.db.handleError(pr(this.La,x,g,u.length,0))},r.prototype.mb=function(u,x){x==null&&(x=this.Ja,this.Ja+=1),this.db.handleError((u===(u|0)?Hs:Ts)(this.La,x,u))},r.prototype.zb=function(u){u==null&&(u=this.Ja,this.Ja+=1),pr(this.La,u,0,0,0)},r.prototype.ob=function(u,x){switch(x==null&&(x=this.Ja,this.Ja+=1),typeof u){case"string":this.nb(u,x);return;case"number":this.mb(u,x);return;case"bigint":this.nb(u.toString(),x);return;case"boolean":this.mb(u+0,x);return;case"object":if(u===null){this.zb(x);return}if(u.length!=null){this.wb(u,x);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+u+")."},r.prototype.yb=function(u){var x=this;return Object.keys(u).forEach(function(g){var w=Ds(x.La,g);w!==0&&x.ob(u[g],w)}),!0},r.prototype.xb=function(u){for(var x=0;x<u.length;x+=1)this.ob(u[x],x+1);return!0},r.prototype.reset=function(){return this.freemem(),$s(this.La)===0&&Vs(this.La)===0},r.prototype.freemem=function(){for(var u;(u=this.fb.pop())!==void 0;)wt(u)},r.prototype.free=function(){this.freemem();var u=Js(this.La)===0;return delete this.db.Za[this.La],this.La=0,u},i.prototype.next=function(){if(this.Ya===null)return{done:!0};if(this.Ua!==null&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var u=$e(),x=ye(4);Be(h),Be(x);try{this.db.handleError(mr(this.db.db,this.eb,-1,h,x)),this.eb=ce(x,"i32");var g=ce(h,"i32");return g===0?(this.gb(),{done:!0}):(this.Ua=new r(g,this.db),this.db.Za[g]=this.Ua,{value:this.Ua,done:!1})}catch(w){throw this.ib=U(this.eb),this.gb(),w}finally{Je(u)}},i.prototype.gb=function(){wt(this.Ya),this.Ya=null},i.prototype.getRemainingSQL=function(){return this.ib!==null?this.ib:U(this.eb)},typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(i.prototype[Symbol.iterator]=function(){return this}),a.prototype.run=function(u,x){if(!this.db)throw"Database closed";if(x){u=this.prepare(u,x);try{u.step()}finally{u.free()}}else this.handleError(z(this.db,u,0,0,h));return this},a.prototype.exec=function(u,x,g){if(!this.db)throw"Database closed";var w=$e(),I=null;try{var L=Oe(u)+1,ie=ye(L);ve(u,B,ie,L);var $=ie,ee=ye(4);for(u=[];ce($,"i8")!==0;){Be(h),Be(ee),this.handleError(mr(this.db,$,-1,h,ee));var te=ce(h,"i32");if($=ce(ee,"i32"),te!==0){for(L=null,I=new r(te,this),x!=null&&I.bind(x);I.step();)L===null&&(L={columns:I.getColumnNames(),values:[]},u.push(L)),L.values.push(I.get(null,g));I.free()}}return u}catch(Ye){throw I&&I.free(),Ye}finally{Je(w)}},a.prototype.each=function(u,x,g,w,I){typeof x=="function"&&(w=g,g=x,x=void 0),u=this.prepare(u,x);try{for(;u.step();)g(u.getAsObject(null,I))}finally{u.free()}if(typeof w=="function")return w()},a.prototype.prepare=function(u,x){if(Be(h),this.handleError(de(this.db,u,-1,h,0)),u=ce(h,"i32"),u===0)throw"Nothing to prepare";var g=new r(u,this);return x!=null&&g.bind(x),this.Za[u]=g},a.prototype.iterateStatements=function(u){return new i(u,this)},a.prototype.export=function(){Object.values(this.Za).forEach(function(x){x.free()}),Object.values(this.Na).forEach(Ve),this.Na={},this.handleError(O(this.db));var u=Es(this.filename);return this.handleError(_(this.filename,h)),this.db=ce(h,"i32"),u},a.prototype.close=function(){this.db!==null&&(Object.values(this.Za).forEach(function(u){u.free()}),Object.values(this.Na).forEach(Ve),this.Na={},this.handleError(O(this.db)),Jn("/"+this.filename),this.db=null)},a.prototype.handleError=function(u){if(u===0)return null;throw u=Ps(this.db),Error(u)},a.prototype.getRowsModified=function(){return P(this.db)},a.prototype.create_function=function(u,x){Object.prototype.hasOwnProperty.call(this.Na,u)&&(Ve(this.Na[u]),delete this.Na[u]);var g=en(function(w,I,L){I=t(I,L);try{var ie=x.apply(null,I)}catch($){_t(w,$,-1);return}e(w,ie)},"viii");return this.Na[u]=g,this.handleError(yr(this.db,u,x.length,1,0,g,0,0,0)),this},a.prototype.create_aggregate=function(u,x){var g=x.init||function(){return null},w=x.finalize||function(ee){return ee},I=x.step;if(!I)throw"An aggregate function must have a step function in "+u;var L={};Object.hasOwnProperty.call(this.Na,u)&&(Ve(this.Na[u]),delete this.Na[u]),x=u+"__finalize",Object.hasOwnProperty.call(this.Na,x)&&(Ve(this.Na[x]),delete this.Na[x]);var ie=en(function(ee,te,Ye){var Me=jr(ee,1);Object.hasOwnProperty.call(L,Me)||(L[Me]=g()),te=t(te,Ye),te=[L[Me]].concat(te);try{L[Me]=I.apply(null,te)}catch(ai){delete L[Me],_t(ee,ai,-1)}},"viii"),$=en(function(ee){var te=jr(ee,1);try{var Ye=w(L[te])}catch(Me){delete L[te],_t(ee,Me,-1);return}e(ee,Ye),delete L[te]},"vi");return this.Na[u]=ie,this.Na[x]=$,this.handleError(yr(this.db,u,I.length-1,1,0,0,ie,$,0)),this},s.Database=a};var j=Object.assign({},s),S="./this.program",b=typeof window=="object",M=typeof importScripts=="function",A=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",C="",R,X,be,Ce,ze,Lt;A?(C=M?require("path").dirname(C)+"/":__dirname+"/",Lt=()=>{ze||(Ce=require("fs"),ze=require("path"))},R=function(e,t){return Lt(),e=ze.normalize(e),Ce.readFileSync(e,t?void 0:"utf8")},be=e=>(e=R(e,!0),e.buffer||(e=new Uint8Array(e)),e),X=(e,t,r)=>{Lt(),e=ze.normalize(e),Ce.readFile(e,function(i,a){i?r(i):t(a.buffer)})},1<process.argv.length&&(S=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),typeof He<"u"&&(He.exports=s),s.inspect=function(){return"[Emscripten Module object]"}):(b||M)&&(M?C=self.location.href:typeof document<"u"&&document.currentScript&&(C=document.currentScript.src),C=C.indexOf("blob:")!==0?C.substr(0,C.replace(/[?#].*/,"").lastIndexOf("/")+1):"",R=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},M&&(be=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),X=(e,t,r)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{i.status==200||i.status==0&&i.response?t(i.response):r()},i.onerror=r,i.send(null)});var qn=s.print||console.log.bind(console),we=s.printErr||console.warn.bind(console);Object.assign(s,j),j=null,s.thisProgram&&(S=s.thisProgram);var Pe;s.wasmBinary&&(Pe=s.wasmBinary),s.noExitRuntime,typeof WebAssembly!="object"&&fe("no native wasm support detected");var Tt,An=!1,In=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ke(e,t,r){var i=t+r;for(r=t;e[r]&&!(r>=i);)++r;if(16<r-t&&e.buffer&&In)return In.decode(e.subarray(t,r));for(i="";t<r;){var a=e[t++];if(a&128){var h=e[t++]&63;if((a&224)==192)i+=String.fromCharCode((a&31)<<6|h);else{var f=e[t++]&63;a=(a&240)==224?(a&15)<<12|h<<6|f:(a&7)<<18|h<<12|f<<6|e[t++]&63,65536>a?i+=String.fromCharCode(a):(a-=65536,i+=String.fromCharCode(55296|a>>10,56320|a&1023))}}else i+=String.fromCharCode(a)}return i}function U(e,t){return e?Ke(re,e,t):""}function ve(e,t,r,i){if(!(0<i))return 0;var a=r;i=r+i-1;for(var h=0;h<e.length;++h){var f=e.charCodeAt(h);if(55296<=f&&57343>=f){var _=e.charCodeAt(++h);f=65536+((f&1023)<<10)|_&1023}if(127>=f){if(r>=i)break;t[r++]=f}else{if(2047>=f){if(r+1>=i)break;t[r++]=192|f>>6}else{if(65535>=f){if(r+2>=i)break;t[r++]=224|f>>12}else{if(r+3>=i)break;t[r++]=240|f>>18,t[r++]=128|f>>12&63}t[r++]=128|f>>6&63}t[r++]=128|f&63}}return t[r]=0,r-a}function Oe(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);127>=i?t++:2047>=i?t+=2:55296<=i&&57343>=i?(t+=4,++r):t+=3}return t}var Ht,B,re,ut,v,D,Dt,Ft;function En(){var e=Tt.buffer;Ht=e,s.HEAP8=B=new Int8Array(e),s.HEAP16=ut=new Int16Array(e),s.HEAP32=v=new Int32Array(e),s.HEAPU8=re=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=D=new Uint32Array(e),s.HEAPF32=Dt=new Float32Array(e),s.HEAPF64=Ft=new Float64Array(e)}var he,Cn=[],zn=[],On=[];function js(){var e=s.preRun.shift();Cn.unshift(e)}var _e=0,Ne=null;function fe(e){throw s.onAbort&&s.onAbort(e),e="Aborted("+e+")",we(e),An=!0,new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info.")}function Rn(){return Z.startsWith("data:application/octet-stream;base64,")}var Z;if(Z="sql-wasm.wasm",!Rn()){var Ln=Z;Z=s.locateFile?s.locateFile(Ln,C):C+Ln}function Tn(){var e=Z;try{if(e==Z&&Pe)return new Uint8Array(Pe);if(be)return be(e);throw"both async and sync fetching of the wasm failed"}catch(t){fe(t)}}function bs(){if(!Pe&&(b||M)){if(typeof fetch=="function"&&!Z.startsWith("file://"))return fetch(Z,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Z+"'";return e.arrayBuffer()}).catch(function(){return Tn()});if(X)return new Promise(function(e,t){X(Z,function(r){e(new Uint8Array(r))},t)})}return Promise.resolve().then(function(){return Tn()})}var k,F;function Pt(e){for(;0<e.length;)e.shift()(s)}function ce(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":return B[e>>0];case"i8":return B[e>>0];case"i16":return ut[e>>1];case"i32":return v[e>>2];case"i64":return v[e>>2];case"float":return Dt[e>>2];case"double":return Ft[e>>3];case"*":return D[e>>2];default:fe("invalid type for getValue: "+t)}return null}function Be(e){var t="i32";switch(t.endsWith("*")&&(t="*"),t){case"i1":B[e>>0]=0;break;case"i8":B[e>>0]=0;break;case"i16":ut[e>>1]=0;break;case"i32":v[e>>2]=0;break;case"i64":F=[0,(k=0,1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[e>>2]=F[0],v[e+4>>2]=F[1];break;case"float":Dt[e>>2]=0;break;case"double":Ft[e>>3]=0;break;case"*":D[e>>2]=0;break;default:fe("invalid type for setValue: "+t)}}var Kt=(e,t)=>{for(var r=0,i=e.length-1;0<=i;i--){var a=e[i];a==="."?e.splice(i,1):a===".."?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},ue=e=>{var t=e.charAt(0)==="/",r=e.substr(-1)==="/";return(e=Kt(e.split("/").filter(i=>!!i),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},ws=e=>{var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],!e&&!t?".":(t&&(t=t.substr(0,t.length-1)),e+t)},dt=e=>{if(e==="/")return"/";e=ue(e),e=e.replace(/\/$/,"");var t=e.lastIndexOf("/");return t===-1?e:e.substr(t+1)};function vs(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(A)try{var t=require("crypto");return()=>t.randomBytes(1)[0]}catch{}return()=>fe("randomDevice")}function ht(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){if(t=0<=r?arguments[r]:"/",typeof t!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t=t.charAt(0)==="/"}return e=Kt(e.split("/").filter(i=>!!i),!t).join("/"),(t?"/":"")+e||"."}function Hn(e,t){var r=Array(Oe(e)+1);return e=ve(e,r,0,r.length),t&&(r.length=e),r}var Dn=[];function Fn(e,t){Dn[e]={input:[],output:[],Xa:t},Wt(e,_s)}var _s={open:function(e){var t=Dn[e.node.rdev];if(!t)throw new m(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.Xa.fsync(e.tty)},fsync:function(e){e.tty.Xa.fsync(e.tty)},read:function(e,t,r,i){if(!e.tty||!e.tty.Xa.tb)throw new m(60);for(var a=0,h=0;h<i;h++){try{var f=e.tty.Xa.tb(e.tty)}catch{throw new m(29)}if(f===void 0&&a===0)throw new m(6);if(f==null)break;a++,t[r+h]=f}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,r,i){if(!e.tty||!e.tty.Xa.jb)throw new m(60);try{for(var a=0;a<i;a++)e.tty.Xa.jb(e.tty,t[r+a])}catch{throw new m(29)}return i&&(e.node.timestamp=Date.now()),a}},ks={tb:function(e){if(!e.input.length){var t=null;if(A){var r=Buffer.alloc(256),i=0;try{i=Ce.readSync(process.stdin.fd,r,0,256,-1)}catch(a){if(a.toString().includes("EOF"))i=0;else throw a}0<i?t=r.slice(0,i).toString("utf-8"):t=null}else typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "),t!==null&&(t+=`
`)):typeof readline=="function"&&(t=readline(),t!==null&&(t+=`
`));if(!t)return null;e.input=Hn(t,!0)}return e.input.shift()},jb:function(e,t){t===null||t===10?(qn(Ke(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},fsync:function(e){e.output&&0<e.output.length&&(qn(Ke(e.output,0)),e.output=[])}},Ss={jb:function(e,t){t===null||t===10?(we(Ke(e.output,0)),e.output=[]):t!=0&&e.output.push(t)},fsync:function(e){e.output&&0<e.output.length&&(we(Ke(e.output,0)),e.output=[])}},q={Qa:null,Ra:function(){return q.createNode(null,"/",16895,0)},createNode:function(e,t,r,i){if((r&61440)===24576||(r&61440)===4096)throw new m(63);return q.Qa||(q.Qa={dir:{node:{Pa:q.Ga.Pa,Oa:q.Ga.Oa,lookup:q.Ga.lookup,ab:q.Ga.ab,rename:q.Ga.rename,unlink:q.Ga.unlink,rmdir:q.Ga.rmdir,readdir:q.Ga.readdir,symlink:q.Ga.symlink},stream:{Ta:q.Ha.Ta}},file:{node:{Pa:q.Ga.Pa,Oa:q.Ga.Oa},stream:{Ta:q.Ha.Ta,read:q.Ha.read,write:q.Ha.write,lb:q.Ha.lb,bb:q.Ha.bb,cb:q.Ha.cb}},link:{node:{Pa:q.Ga.Pa,Oa:q.Ga.Oa,readlink:q.Ga.readlink},stream:{}},pb:{node:{Pa:q.Ga.Pa,Oa:q.Ga.Oa},stream:Is}}),r=Bn(e,t,r,i),(r.mode&61440)===16384?(r.Ga=q.Qa.dir.node,r.Ha=q.Qa.dir.stream,r.Ia={}):(r.mode&61440)===32768?(r.Ga=q.Qa.file.node,r.Ha=q.Qa.file.stream,r.Ma=0,r.Ia=null):(r.mode&61440)===40960?(r.Ga=q.Qa.link.node,r.Ha=q.Qa.link.stream):(r.mode&61440)===8192&&(r.Ga=q.Qa.pb.node,r.Ha=q.Qa.pb.stream),r.timestamp=Date.now(),e&&(e.Ia[t]=r,e.timestamp=r.timestamp),r},Jb:function(e){return e.Ia?e.Ia.subarray?e.Ia.subarray(0,e.Ma):new Uint8Array(e.Ia):new Uint8Array(0)},qb:function(e,t){var r=e.Ia?e.Ia.length:0;r>=t||(t=Math.max(t,r*(1048576>r?2:1.125)>>>0),r!=0&&(t=Math.max(t,256)),r=e.Ia,e.Ia=new Uint8Array(t),0<e.Ma&&e.Ia.set(r.subarray(0,e.Ma),0))},Gb:function(e,t){if(e.Ma!=t)if(t==0)e.Ia=null,e.Ma=0;else{var r=e.Ia;e.Ia=new Uint8Array(t),r&&e.Ia.set(r.subarray(0,Math.min(t,e.Ma))),e.Ma=t}},Ga:{Pa:function(e){var t={};return t.dev=(e.mode&61440)===8192?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,(e.mode&61440)===16384?t.size=4096:(e.mode&61440)===32768?t.size=e.Ma:(e.mode&61440)===40960?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.Ab=4096,t.blocks=Math.ceil(t.size/t.Ab),t},Oa:function(e,t){t.mode!==void 0&&(e.mode=t.mode),t.timestamp!==void 0&&(e.timestamp=t.timestamp),t.size!==void 0&&q.Gb(e,t.size)},lookup:function(){throw Bt[44]},ab:function(e,t,r,i){return q.createNode(e,t,r,i)},rename:function(e,t,r){if((e.mode&61440)===16384){try{var i=ke(t,r)}catch{}if(i)for(var a in i.Ia)throw new m(55)}delete e.parent.Ia[e.name],e.parent.timestamp=Date.now(),e.name=r,t.Ia[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.Ia[t],e.timestamp=Date.now()},rmdir:function(e,t){var r=ke(e,t),i;for(i in r.Ia)throw new m(55);delete e.Ia[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."],r;for(r in e.Ia)e.Ia.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){return e=q.createNode(e,t,41471,0),e.link=r,e},readlink:function(e){if((e.mode&61440)!==40960)throw new m(28);return e.link}},Ha:{read:function(e,t,r,i,a){var h=e.node.Ia;if(a>=e.node.Ma)return 0;if(e=Math.min(e.node.Ma-a,i),8<e&&h.subarray)t.set(h.subarray(a,a+e),r);else for(i=0;i<e;i++)t[r+i]=h[a+i];return e},write:function(e,t,r,i,a,h){if(t.buffer===B.buffer&&(h=!1),!i)return 0;if(e=e.node,e.timestamp=Date.now(),t.subarray&&(!e.Ia||e.Ia.subarray)){if(h)return e.Ia=t.subarray(r,r+i),e.Ma=i;if(e.Ma===0&&a===0)return e.Ia=t.slice(r,r+i),e.Ma=i;if(a+i<=e.Ma)return e.Ia.set(t.subarray(r,r+i),a),i}if(q.qb(e,a+i),e.Ia.subarray&&t.subarray)e.Ia.set(t.subarray(r,r+i),a);else for(h=0;h<i;h++)e.Ia[a+h]=t[r+h];return e.Ma=Math.max(e.Ma,a+i),i},Ta:function(e,t,r){if(r===1?t+=e.position:r===2&&(e.node.mode&61440)===32768&&(t+=e.node.Ma),0>t)throw new m(28);return t},lb:function(e,t,r){q.qb(e.node,t+r),e.node.Ma=Math.max(e.node.Ma,t+r)},bb:function(e,t,r,i,a){if((e.node.mode&61440)!==32768)throw new m(43);if(e=e.node.Ia,a&2||e.buffer!==Ht){if((0<r||r+t<e.length)&&(e.subarray?e=e.subarray(r,r+t):e=Array.prototype.slice.call(e,r,r+t)),r=!0,t=65536*Math.ceil(t/65536),(a=dr(65536,t))?(re.fill(0,a,a+t),t=a):t=0,!t)throw new m(48);B.set(e,t)}else r=!1,t=e.byteOffset;return{Fb:t,vb:r}},cb:function(e,t,r,i,a){if((e.node.mode&61440)!==32768)throw new m(43);return a&2||q.Ha.write(e,t,0,i,r,!1),0}}},Nt=null,Pn={},me=[],Ms=1,pe=null,Kn=!0,m=null,Bt={},Q=(e,t={})=>{if(e=ht("/",e),!e)return{path:"",node:null};if(t=Object.assign({rb:!0,kb:0},t),8<t.kb)throw new m(32);e=Kt(e.split("/").filter(f=>!!f),!1);for(var r=Nt,i="/",a=0;a<e.length;a++){var h=a===e.length-1;if(h&&t.parent)break;if(r=ke(r,e[a]),i=ue(i+"/"+e[a]),r.Va&&(!h||h&&t.rb)&&(r=r.Va.root),!h||t.Sa){for(h=0;(r.mode&61440)===40960;)if(r=Yn(i),i=ht(ws(i),r),r=Q(i,{kb:t.kb+1}).node,40<h++)throw new m(32)}}return{path:i,node:r}},Ue=e=>{for(var t;;){if(e===e.parent)return e=e.Ra.ub,t?e[e.length-1]!=="/"?e+"/"+t:e+t:e;t=t?e.name+"/"+t:e.name,e=e.parent}},Ut=(e,t)=>{for(var r=0,i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return(e+r>>>0)%pe.length},Nn=e=>{var t=Ut(e.parent.id,e.name);if(pe[t]===e)pe[t]=e.Wa;else for(t=pe[t];t;){if(t.Wa===e){t.Wa=e.Wa;break}t=t.Wa}},ke=(e,t)=>{var r;if(r=(r=Re(e,"x"))?r:e.Ga.lookup?0:2)throw new m(r,e);for(r=pe[Ut(e.id,t)];r;r=r.Wa){var i=r.name;if(r.parent.id===e.id&&i===t)return r}return e.Ga.lookup(e,t)},Bn=(e,t,r,i)=>(e=new cr(e,t,r,i),t=Ut(e.parent.id,e.name),e.Wa=pe[t],pe[t]=e),qs={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},Un=e=>{var t=["r","w","rw"][e&3];return e&512&&(t+="w"),t},Re=(e,t)=>{if(Kn)return 0;if(!t.includes("r")||e.mode&292){if(t.includes("w")&&!(e.mode&146)||t.includes("x")&&!(e.mode&73))return 2}else return 2;return 0},Wn=(e,t)=>{try{return ke(e,t),20}catch{}return Re(e,"wx")},Gn=(e,t,r)=>{try{var i=ke(e,t)}catch(a){return a.Ka}if(e=Re(e,"wx"))return e;if(r){if((i.mode&61440)!==16384)return 54;if(i===i.parent||Ue(i)==="/")return 10}else if((i.mode&61440)===16384)return 31;return 0},As=(e=0)=>{for(;4096>=e;e++)if(!me[e])return e;throw new m(33)},Qn=(e,t)=>(Qe||(Qe=function(){this.$a={}},Qe.prototype={},Object.defineProperties(Qe.prototype,{object:{get:function(){return this.node},set:function(r){this.node=r}},flags:{get:function(){return this.$a.flags},set:function(r){this.$a.flags=r}},position:{get:function(){return this.$a.position},set:function(r){this.$a.position=r}}})),e=Object.assign(new Qe,e),t=As(t),e.fd=t,me[t]=e),Is={open:e=>{e.Ha=Pn[e.node.rdev].Ha,e.Ha.open&&e.Ha.open(e)},Ta:()=>{throw new m(70)}},Wt=(e,t)=>{Pn[e]={Ha:t}},Vn=(e,t)=>{var r=t==="/",i=!t;if(r&&Nt)throw new m(10);if(!r&&!i){var a=Q(t,{rb:!1});if(t=a.path,a=a.node,a.Va)throw new m(10);if((a.mode&61440)!==16384)throw new m(54)}t={type:e,Kb:{},ub:t,Eb:[]},e=e.Ra(t),e.Ra=t,t.root=e,r?Nt=e:a&&(a.Va=t,a.Ra&&a.Ra.Eb.push(t))},ft=(e,t,r)=>{var i=Q(e,{parent:!0}).node;if(e=dt(e),!e||e==="."||e==="..")throw new m(28);var a=Wn(i,e);if(a)throw new m(a);if(!i.Ga.ab)throw new m(63);return i.Ga.ab(i,e,t,r)},se=(e,t)=>ft(e,(t!==void 0?t:511)&1023|16384,0),mt=(e,t,r)=>{typeof r>"u"&&(r=t,t=438),ft(e,t|8192,r)},Gt=(e,t)=>{if(!ht(e))throw new m(44);var r=Q(t,{parent:!0}).node;if(!r)throw new m(44);t=dt(t);var i=Wn(r,t);if(i)throw new m(i);if(!r.Ga.symlink)throw new m(63);r.Ga.symlink(r,t,e)},$n=e=>{var t=Q(e,{parent:!0}).node;e=dt(e);var r=ke(t,e),i=Gn(t,e,!0);if(i)throw new m(i);if(!t.Ga.rmdir)throw new m(63);if(r.Va)throw new m(10);t.Ga.rmdir(t,e),Nn(r)},Jn=e=>{var t=Q(e,{parent:!0}).node;if(!t)throw new m(44);e=dt(e);var r=ke(t,e),i=Gn(t,e,!1);if(i)throw new m(i);if(!t.Ga.unlink)throw new m(63);if(r.Va)throw new m(10);t.Ga.unlink(t,e),Nn(r)},Yn=e=>{if(e=Q(e).node,!e)throw new m(44);if(!e.Ga.readlink)throw new m(28);return ht(Ue(e.parent),e.Ga.readlink(e))},We=(e,t)=>{if(e=Q(e,{Sa:!t}).node,!e)throw new m(44);if(!e.Ga.Pa)throw new m(63);return e.Ga.Pa(e)},Xn=e=>We(e,!0),pt=(e,t)=>{if(e=typeof e=="string"?Q(e,{Sa:!0}).node:e,!e.Ga.Oa)throw new m(63);e.Ga.Oa(e,{mode:t&4095|e.mode&-4096,timestamp:Date.now()})},Zn=(e,t)=>{if(0>t)throw new m(28);if(e=typeof e=="string"?Q(e,{Sa:!0}).node:e,!e.Ga.Oa)throw new m(63);if((e.mode&61440)===16384)throw new m(31);if((e.mode&61440)!==32768)throw new m(28);var r=Re(e,"w");if(r)throw new m(r);e.Ga.Oa(e,{size:t,timestamp:Date.now()})},Le=(e,t,r)=>{if(e==="")throw new m(44);if(typeof t=="string"){var i=qs[t];if(typeof i>"u")throw Error("Unknown file open mode: "+t);t=i}if(r=t&64?(typeof r>"u"?438:r)&4095|32768:0,typeof e=="object")var a=e;else{e=ue(e);try{a=Q(e,{Sa:!(t&131072)}).node}catch{}}if(i=!1,t&64)if(a){if(t&128)throw new m(20)}else a=ft(e,r,0),i=!0;if(!a)throw new m(44);if((a.mode&61440)===8192&&(t&=-513),t&65536&&(a.mode&61440)!==16384)throw new m(54);if(!i&&(r=a?(a.mode&61440)===40960?32:(a.mode&61440)===16384&&(Un(t)!=="r"||t&512)?31:Re(a,Un(t)):44))throw new m(r);return t&512&&!i&&Zn(a,0),t&=-131713,a=Qn({node:a,path:Ue(a),flags:t,seekable:!0,position:0,Ha:a.Ha,Ib:[],error:!1}),a.Ha.open&&a.Ha.open(a),!s.logReadFiles||t&1||(xt||(xt={}),e in xt||(xt[e]=1)),a},Qt=e=>{if(e.fd===null)throw new m(8);e.hb&&(e.hb=null);try{e.Ha.close&&e.Ha.close(e)}catch(t){throw t}finally{me[e.fd]=null}e.fd=null},er=(e,t,r)=>{if(e.fd===null)throw new m(8);if(!e.seekable||!e.Ha.Ta)throw new m(70);if(r!=0&&r!=1&&r!=2)throw new m(28);e.position=e.Ha.Ta(e,t,r),e.Ib=[]},tr=(e,t,r,i,a)=>{if(0>i||0>a)throw new m(28);if(e.fd===null)throw new m(8);if((e.flags&2097155)===1)throw new m(8);if((e.node.mode&61440)===16384)throw new m(31);if(!e.Ha.read)throw new m(28);var h=typeof a<"u";if(!h)a=e.position;else if(!e.seekable)throw new m(70);return t=e.Ha.read(e,t,r,i,a),h||(e.position+=t),t},nr=(e,t,r,i,a)=>{if(0>i||0>a)throw new m(28);if(e.fd===null)throw new m(8);if(!(e.flags&2097155))throw new m(8);if((e.node.mode&61440)===16384)throw new m(31);if(!e.Ha.write)throw new m(28);e.seekable&&e.flags&1024&&er(e,0,2);var h=typeof a<"u";if(!h)a=e.position;else if(!e.seekable)throw new m(70);return t=e.Ha.write(e,t,r,i,a,void 0),h||(e.position+=t),t},Es=e=>{var t,r=Le(e,r||0);e=We(e).size;var i=new Uint8Array(e);return tr(r,i,0,e,0),t=i,Qt(r),t},rr=()=>{m||(m=function(e,t){this.node=t,this.Hb=function(r){this.Ka=r},this.Hb(e),this.message="FS error"},m.prototype=Error(),m.prototype.constructor=m,[44].forEach(e=>{Bt[e]=new m(e),Bt[e].stack="<generic error, no stack>"}))},sr,ir=(e,t)=>{var r=0;return e&&(r|=365),t&&(r|=146),r},Ge=(e,t,r)=>{e=ue("/dev/"+e);var i=ir(!!t,!!r);Vt||(Vt=64);var a=Vt++<<8|0;Wt(a,{open:h=>{h.seekable=!1},close:()=>{r&&r.buffer&&r.buffer.length&&r(10)},read:(h,f,_,O)=>{for(var z=0,P=0;P<O;P++){try{var de=t()}catch{throw new m(29)}if(de===void 0&&z===0)throw new m(6);if(de==null)break;z++,f[_+P]=de}return z&&(h.node.timestamp=Date.now()),z},write:(h,f,_,O)=>{for(var z=0;z<O;z++)try{r(f[_+z])}catch{throw new m(29)}return O&&(h.node.timestamp=Date.now()),z}}),mt(e,i,a)},Vt,H={},Qe,xt;function Se(e,t,r){if(t.charAt(0)==="/")return t;if(e=e===-100?"/":ne(e).path,t.length==0){if(!r)throw new m(44);return e}return ue(e+"/"+t)}function yt(e,t,r){try{var i=e(t)}catch(a){if(a&&a.node&&ue(t)!==ue(Ue(a.node)))return-54;throw a}return v[r>>2]=i.dev,v[r+8>>2]=i.ino,v[r+12>>2]=i.mode,D[r+16>>2]=i.nlink,v[r+20>>2]=i.uid,v[r+24>>2]=i.gid,v[r+28>>2]=i.rdev,F=[i.size>>>0,(k=i.size,1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[r+40>>2]=F[0],v[r+44>>2]=F[1],v[r+48>>2]=4096,v[r+52>>2]=i.blocks,F=[Math.floor(i.atime.getTime()/1e3)>>>0,(k=Math.floor(i.atime.getTime()/1e3),1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[r+56>>2]=F[0],v[r+60>>2]=F[1],D[r+64>>2]=0,F=[Math.floor(i.mtime.getTime()/1e3)>>>0,(k=Math.floor(i.mtime.getTime()/1e3),1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[r+72>>2]=F[0],v[r+76>>2]=F[1],D[r+80>>2]=0,F=[Math.floor(i.ctime.getTime()/1e3)>>>0,(k=Math.floor(i.ctime.getTime()/1e3),1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[r+88>>2]=F[0],v[r+92>>2]=F[1],D[r+96>>2]=0,F=[i.ino>>>0,(k=i.ino,1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[r+104>>2]=F[0],v[r+108>>2]=F[1],0}var gt=void 0;function jt(){return gt+=4,v[gt-4>>2]}function ne(e){if(e=me[e],!e)throw new m(8);return e}function $t(e){return D[e>>2]+4294967296*v[e+4>>2]}function or(e){var t=Oe(e)+1,r=bt(t);return r&&ve(e,B,r,t),r}function Cs(e,t,r){function i(O){return(O=O.toTimeString().match(/\(([A-Za-z ]+)\)$/))?O[1]:"GMT"}var a=new Date().getFullYear(),h=new Date(a,0,1),f=new Date(a,6,1);a=h.getTimezoneOffset();var _=f.getTimezoneOffset();v[e>>2]=60*Math.max(a,_),v[t>>2]=+(a!=_),e=i(h),t=i(f),e=or(e),t=or(t),_<a?(D[r>>2]=e,D[r+4>>2]=t):(D[r>>2]=t,D[r+4>>2]=e)}function Jt(e,t,r){Jt.Bb||(Jt.Bb=!0,Cs(e,t,r))}var ar;ar=A?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.now();var Yt={};function lr(){if(!Xt){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:S||"./this.program"},t;for(t in Yt)Yt[t]===void 0?delete e[t]:e[t]=Yt[t];var r=[];for(t in e)r.push(t+"="+e[t]);Xt=r}return Xt}var Xt,xe=void 0,Zt=[];function en(e,t){if(!xe){xe=new WeakMap;var r=he.length;if(xe)for(var i=0;i<0+r;i++){var a=he.get(i);a&&xe.set(a,i)}}if(xe.has(e))return xe.get(e);if(Zt.length)r=Zt.pop();else{try{he.grow(1)}catch(_){throw _ instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":_}r=he.length-1}try{he.set(r,e)}catch(_){if(!(_ instanceof TypeError))throw _;if(typeof WebAssembly.Function=="function"){i=WebAssembly.Function,a={i:"i32",j:"i64",f:"f32",d:"f64",p:"i32"};for(var h={parameters:[],results:t[0]=="v"?[]:[a[t[0]]]},f=1;f<t.length;++f)h.parameters.push(a[t[f]]);t=new i(h,e)}else{for(i=[1,96],a=t.slice(0,1),t=t.slice(1),h={i:127,p:127,j:126,f:125,d:124},f=t.length,128>f?i.push(f):i.push(f%128|128,f>>7),f=0;f<t.length;++f)i.push(h[t[f]]);a=="v"?i.push(0):i.push(1,h[a]),t=[0,97,115,109,1,0,0,0,1],a=i.length,128>a?t.push(a):t.push(a%128|128,a>>7),t.push.apply(t,i),t.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),t=new WebAssembly.Module(new Uint8Array(t)),t=new WebAssembly.Instance(t,{e:{f:e}}).exports.f}he.set(r,t)}return xe.set(e,r),r}function Ve(e){xe.delete(he.get(e)),Zt.push(e)}function tn(e){var t=bt(e.length);return e.subarray||e.slice||(e=new Uint8Array(e)),re.set(e,t),t}function zs(e,t,r,i){var a={string:z=>{var P=0;if(z!=null&&z!==0){var de=(z.length<<2)+1;P=ye(de),ve(z,re,P,de)}return P},array:z=>{var P=ye(z.length);return B.set(z,P),P}};e=s["_"+e];var h=[],f=0;if(i)for(var _=0;_<i.length;_++){var O=a[r[_]];O?(f===0&&(f=$e()),h[_]=O(i[_])):h[_]=i[_]}return r=e.apply(null,h),r=function(z){return f!==0&&Je(f),t==="string"?U(z):t==="boolean"?!!z:z}(r)}function cr(e,t,r,i){e||(e=this),this.parent=e,this.Ra=e.Ra,this.Va=null,this.id=Ms++,this.name=t,this.mode=r,this.Ga={},this.Ha={},this.rdev=i}Object.defineProperties(cr.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(e){e?this.mode|=146:this.mode&=-147}}}),rr(),pe=Array(4096),Vn(q,"/"),se("/tmp"),se("/home"),se("/home/web_user"),(()=>{se("/dev"),Wt(259,{read:()=>0,write:(t,r,i,a)=>a}),mt("/dev/null",259),Fn(1280,ks),Fn(1536,Ss),mt("/dev/tty",1280),mt("/dev/tty1",1536);var e=vs();Ge("random",e),Ge("urandom",e),se("/dev/shm"),se("/dev/shm/tmp")})(),(()=>{se("/proc");var e=se("/proc/self");se("/proc/self/fd"),Vn({Ra:()=>{var t=Bn(e,"fd",16895,73);return t.Ga={lookup:(r,i)=>{var a=me[+i];if(!a)throw new m(8);return r={parent:null,Ra:{ub:"fake"},Ga:{readlink:()=>a.path}},r.parent=r}},t}},"/proc/self/fd")})();var Os={a:function(e,t,r,i){fe("Assertion failed: "+U(e)+", at: "+[t?U(t):"unknown filename",r,i?U(i):"unknown function"])},h:function(e,t){try{return e=U(e),pt(e,t),0}catch(r){if(typeof H>"u"||!(r instanceof m))throw r;return-r.Ka}},H:function(e,t,r){try{if(t=U(t),t=Se(e,t),r&-8)return-28;var i=Q(t,{Sa:!0}).node;return i?(e="",r&4&&(e+="r"),r&2&&(e+="w"),r&1&&(e+="x"),e&&Re(i,e)?-2:0):-44}catch(a){if(typeof H>"u"||!(a instanceof m))throw a;return-a.Ka}},i:function(e,t){try{var r=me[e];if(!r)throw new m(8);return pt(r.node,t),0}catch(i){if(typeof H>"u"||!(i instanceof m))throw i;return-i.Ka}},g:function(e){try{var t=me[e];if(!t)throw new m(8);var r=t.node,i=typeof r=="string"?Q(r,{Sa:!0}).node:r;if(!i.Ga.Oa)throw new m(63);return i.Ga.Oa(i,{timestamp:Date.now()}),0}catch(a){if(typeof H>"u"||!(a instanceof m))throw a;return-a.Ka}},b:function(e,t,r){gt=r;try{var i=ne(e);switch(t){case 0:var a=jt();return 0>a?-28:Qn(i,a).fd;case 1:case 2:return 0;case 3:return i.flags;case 4:return a=jt(),i.flags|=a,0;case 5:return a=jt(),ut[a+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return v[ur()>>2]=28,-1;default:return-28}}catch(h){if(typeof H>"u"||!(h instanceof m))throw h;return-h.Ka}},G:function(e,t){try{var r=ne(e);return yt(We,r.path,t)}catch(i){if(typeof H>"u"||!(i instanceof m))throw i;return-i.Ka}},l:function(e,t,r){try{if(t=r+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*r:NaN,isNaN(t))return-61;var i=me[e];if(!i)throw new m(8);if(!(i.flags&2097155))throw new m(28);return Zn(i.node,t),0}catch(a){if(typeof H>"u"||!(a instanceof m))throw a;return-a.Ka}},B:function(e,t){try{if(t===0)return-28;var r=Oe("/")+1;return t<r?-68:(ve("/",re,e,t),r)}catch(i){if(typeof H>"u"||!(i instanceof m))throw i;return-i.Ka}},E:function(e,t){try{return e=U(e),yt(Xn,e,t)}catch(r){if(typeof H>"u"||!(r instanceof m))throw r;return-r.Ka}},y:function(e,t,r){try{return t=U(t),t=Se(e,t),t=ue(t),t[t.length-1]==="/"&&(t=t.substr(0,t.length-1)),se(t,r),0}catch(i){if(typeof H>"u"||!(i instanceof m))throw i;return-i.Ka}},D:function(e,t,r,i){try{t=U(t);var a=i&256;return t=Se(e,t,i&4096),yt(a?Xn:We,t,r)}catch(h){if(typeof H>"u"||!(h instanceof m))throw h;return-h.Ka}},v:function(e,t,r,i){gt=i;try{t=U(t),t=Se(e,t);var a=i?jt():0;return Le(t,r,a).fd}catch(h){if(typeof H>"u"||!(h instanceof m))throw h;return-h.Ka}},t:function(e,t,r,i){try{if(t=U(t),t=Se(e,t),0>=i)return-28;var a=Yn(t),h=Math.min(i,Oe(a)),f=B[r+h];return ve(a,re,r,i+1),B[r+h]=f,h}catch(_){if(typeof H>"u"||!(_ instanceof m))throw _;return-_.Ka}},s:function(e){try{return e=U(e),$n(e),0}catch(t){if(typeof H>"u"||!(t instanceof m))throw t;return-t.Ka}},F:function(e,t){try{return e=U(e),yt(We,e,t)}catch(r){if(typeof H>"u"||!(r instanceof m))throw r;return-r.Ka}},p:function(e,t,r){try{return t=U(t),t=Se(e,t),r===0?Jn(t):r===512?$n(t):fe("Invalid flags passed to unlinkat"),0}catch(i){if(typeof H>"u"||!(i instanceof m))throw i;return-i.Ka}},o:function(e,t,r){try{if(t=U(t),t=Se(e,t,!0),r){var i=$t(r),a=v[r+8>>2];h=1e3*i+a/1e6,r+=16,i=$t(r),a=v[r+8>>2],f=1e3*i+a/1e6}else var h=Date.now(),f=h;e=h;var _=Q(t,{Sa:!0}).node;return _.Ga.Oa(_,{timestamp:Math.max(e,f)}),0}catch(O){if(typeof H>"u"||!(O instanceof m))throw O;return-O.Ka}},e:function(){return Date.now()},j:function(e,t){e=new Date(1e3*$t(e)),v[t>>2]=e.getSeconds(),v[t+4>>2]=e.getMinutes(),v[t+8>>2]=e.getHours(),v[t+12>>2]=e.getDate(),v[t+16>>2]=e.getMonth(),v[t+20>>2]=e.getFullYear()-1900,v[t+24>>2]=e.getDay();var r=new Date(e.getFullYear(),0,1);v[t+28>>2]=(e.getTime()-r.getTime())/864e5|0,v[t+36>>2]=-(60*e.getTimezoneOffset());var i=new Date(e.getFullYear(),6,1).getTimezoneOffset();r=r.getTimezoneOffset(),v[t+32>>2]=(i!=r&&e.getTimezoneOffset()==Math.min(r,i))|0},w:function(e,t,r,i,a,h){try{var f=ne(i);if(t&2&&!(r&2)&&(f.flags&2097155)!==2)throw new m(2);if((f.flags&2097155)===1)throw new m(2);if(!f.Ha.bb)throw new m(43);var _=f.Ha.bb(f,e,a,t,r),O=_.Fb;return v[h>>2]=_.vb,O}catch(z){if(typeof H>"u"||!(z instanceof m))throw z;return-z.Ka}},x:function(e,t,r,i,a,h){try{var f=ne(a);if(r&2){var _=re.slice(e,e+t);f&&f.Ha.cb&&f.Ha.cb(f,_,h,t,i)}}catch(O){if(typeof H>"u"||!(O instanceof m))throw O;return-O.Ka}},n:Jt,q:function(){return 2147483648},d:ar,c:function(e){var t=re.length;if(e>>>=0,2147483648<e)return!1;for(var r=1;4>=r;r*=2){var i=t*(1+.2/r);i=Math.min(i,e+100663296);var a=Math;i=Math.max(e,i),a=a.min.call(a,2147483648,i+(65536-i%65536)%65536);e:{try{Tt.grow(a-Ht.byteLength+65535>>>16),En();var h=1;break e}catch{}h=void 0}if(h)return!0}return!1},z:function(e,t){var r=0;return lr().forEach(function(i,a){var h=t+r;for(a=D[e+4*a>>2]=h,h=0;h<i.length;++h)B[a++>>0]=i.charCodeAt(h);B[a>>0]=0,r+=i.length+1}),0},A:function(e,t){var r=lr();D[e>>2]=r.length;var i=0;return r.forEach(function(a){i+=a.length+1}),D[t>>2]=i,0},f:function(e){try{var t=ne(e);return Qt(t),0}catch(r){if(typeof H>"u"||!(r instanceof m))throw r;return r.Ka}},m:function(e,t){try{var r=ne(e);return B[t>>0]=r.tty?2:(r.mode&61440)===16384?3:(r.mode&61440)===40960?7:4,0}catch(i){if(typeof H>"u"||!(i instanceof m))throw i;return i.Ka}},u:function(e,t,r,i){try{e:{var a=ne(e);e=t;for(var h=t=0;h<r;h++){var f=D[e>>2],_=D[e+4>>2];e+=8;var O=tr(a,B,f,_);if(0>O){var z=-1;break e}if(t+=O,O<_)break}z=t}return D[i>>2]=z,0}catch(P){if(typeof H>"u"||!(P instanceof m))throw P;return P.Ka}},k:function(e,t,r,i,a){try{if(t=r+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*r:NaN,isNaN(t))return 61;var h=ne(e);return er(h,t,i),F=[h.position>>>0,(k=h.position,1<=+Math.abs(k)?0<k?(Math.min(+Math.floor(k/4294967296),4294967295)|0)>>>0:~~+Math.ceil((k-+(~~k>>>0))/4294967296)>>>0:0)],v[a>>2]=F[0],v[a+4>>2]=F[1],h.hb&&t===0&&i===0&&(h.hb=null),0}catch(f){if(typeof H>"u"||!(f instanceof m))throw f;return f.Ka}},C:function(e){try{var t=ne(e);return t.Ha&&t.Ha.fsync?t.Ha.fsync(t):0}catch(r){if(typeof H>"u"||!(r instanceof m))throw r;return r.Ka}},r:function(e,t,r,i){try{e:{var a=ne(e);e=t;for(var h=t=0;h<r;h++){var f=D[e>>2],_=D[e+4>>2];e+=8;var O=nr(a,B,f,_);if(0>O){var z=-1;break e}t+=O}z=t}return D[i>>2]=z,0}catch(P){if(typeof H>"u"||!(P instanceof m))throw P;return P.Ka}}};(function(){function e(a){s.asm=a.exports,Tt=s.asm.I,En(),he=s.asm.Aa,zn.unshift(s.asm.J),_e--,s.monitorRunDependencies&&s.monitorRunDependencies(_e),_e==0&&Ne&&(a=Ne,Ne=null,a())}function t(a){e(a.instance)}function r(a){return bs().then(function(h){return WebAssembly.instantiate(h,i)}).then(function(h){return h}).then(a,function(h){we("failed to asynchronously prepare wasm: "+h),fe(h)})}var i={a:Os};if(_e++,s.monitorRunDependencies&&s.monitorRunDependencies(_e),s.instantiateWasm)try{return s.instantiateWasm(i,e)}catch(a){return we("Module.instantiateWasm callback failed with error: "+a),!1}return function(){return Pe||typeof WebAssembly.instantiateStreaming!="function"||Rn()||Z.startsWith("file://")||A||typeof fetch!="function"?r(t):fetch(Z,{credentials:"same-origin"}).then(function(a){return WebAssembly.instantiateStreaming(a,i).then(t,function(h){return we("wasm streaming compile failed: "+h),we("falling back to ArrayBuffer instantiation"),r(t)})})}(),{}})(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.J).apply(null,arguments)},s._sqlite3_free=function(){return(s._sqlite3_free=s.asm.K).apply(null,arguments)},s._sqlite3_value_double=function(){return(s._sqlite3_value_double=s.asm.L).apply(null,arguments)},s._sqlite3_value_text=function(){return(s._sqlite3_value_text=s.asm.M).apply(null,arguments)};var ur=s.___errno_location=function(){return(ur=s.___errno_location=s.asm.N).apply(null,arguments)};s._sqlite3_prepare_v2=function(){return(s._sqlite3_prepare_v2=s.asm.O).apply(null,arguments)},s._sqlite3_step=function(){return(s._sqlite3_step=s.asm.P).apply(null,arguments)},s._sqlite3_finalize=function(){return(s._sqlite3_finalize=s.asm.Q).apply(null,arguments)},s._sqlite3_reset=function(){return(s._sqlite3_reset=s.asm.R).apply(null,arguments)},s._sqlite3_value_int=function(){return(s._sqlite3_value_int=s.asm.S).apply(null,arguments)},s._sqlite3_clear_bindings=function(){return(s._sqlite3_clear_bindings=s.asm.T).apply(null,arguments)},s._sqlite3_value_blob=function(){return(s._sqlite3_value_blob=s.asm.U).apply(null,arguments)},s._sqlite3_value_bytes=function(){return(s._sqlite3_value_bytes=s.asm.V).apply(null,arguments)},s._sqlite3_value_type=function(){return(s._sqlite3_value_type=s.asm.W).apply(null,arguments)},s._sqlite3_result_blob=function(){return(s._sqlite3_result_blob=s.asm.X).apply(null,arguments)},s._sqlite3_result_double=function(){return(s._sqlite3_result_double=s.asm.Y).apply(null,arguments)},s._sqlite3_result_error=function(){return(s._sqlite3_result_error=s.asm.Z).apply(null,arguments)},s._sqlite3_result_int=function(){return(s._sqlite3_result_int=s.asm._).apply(null,arguments)},s._sqlite3_result_int64=function(){return(s._sqlite3_result_int64=s.asm.$).apply(null,arguments)},s._sqlite3_result_null=function(){return(s._sqlite3_result_null=s.asm.aa).apply(null,arguments)},s._sqlite3_result_text=function(){return(s._sqlite3_result_text=s.asm.ba).apply(null,arguments)},s._sqlite3_sql=function(){return(s._sqlite3_sql=s.asm.ca).apply(null,arguments)},s._sqlite3_aggregate_context=function(){return(s._sqlite3_aggregate_context=s.asm.da).apply(null,arguments)},s._sqlite3_column_count=function(){return(s._sqlite3_column_count=s.asm.ea).apply(null,arguments)},s._sqlite3_data_count=function(){return(s._sqlite3_data_count=s.asm.fa).apply(null,arguments)},s._sqlite3_column_blob=function(){return(s._sqlite3_column_blob=s.asm.ga).apply(null,arguments)},s._sqlite3_column_bytes=function(){return(s._sqlite3_column_bytes=s.asm.ha).apply(null,arguments)},s._sqlite3_column_double=function(){return(s._sqlite3_column_double=s.asm.ia).apply(null,arguments)},s._sqlite3_column_text=function(){return(s._sqlite3_column_text=s.asm.ja).apply(null,arguments)},s._sqlite3_column_type=function(){return(s._sqlite3_column_type=s.asm.ka).apply(null,arguments)},s._sqlite3_column_name=function(){return(s._sqlite3_column_name=s.asm.la).apply(null,arguments)},s._sqlite3_bind_blob=function(){return(s._sqlite3_bind_blob=s.asm.ma).apply(null,arguments)},s._sqlite3_bind_double=function(){return(s._sqlite3_bind_double=s.asm.na).apply(null,arguments)},s._sqlite3_bind_int=function(){return(s._sqlite3_bind_int=s.asm.oa).apply(null,arguments)},s._sqlite3_bind_text=function(){return(s._sqlite3_bind_text=s.asm.pa).apply(null,arguments)},s._sqlite3_bind_parameter_index=function(){return(s._sqlite3_bind_parameter_index=s.asm.qa).apply(null,arguments)},s._sqlite3_normalized_sql=function(){return(s._sqlite3_normalized_sql=s.asm.ra).apply(null,arguments)},s._sqlite3_errmsg=function(){return(s._sqlite3_errmsg=s.asm.sa).apply(null,arguments)},s._sqlite3_exec=function(){return(s._sqlite3_exec=s.asm.ta).apply(null,arguments)},s._sqlite3_changes=function(){return(s._sqlite3_changes=s.asm.ua).apply(null,arguments)},s._sqlite3_close_v2=function(){return(s._sqlite3_close_v2=s.asm.va).apply(null,arguments)},s._sqlite3_create_function_v2=function(){return(s._sqlite3_create_function_v2=s.asm.wa).apply(null,arguments)},s._sqlite3_open=function(){return(s._sqlite3_open=s.asm.xa).apply(null,arguments)};var bt=s._malloc=function(){return(bt=s._malloc=s.asm.ya).apply(null,arguments)},wt=s._free=function(){return(wt=s._free=s.asm.za).apply(null,arguments)};s._RegisterExtensionFunctions=function(){return(s._RegisterExtensionFunctions=s.asm.Ba).apply(null,arguments)};var dr=s._emscripten_builtin_memalign=function(){return(dr=s._emscripten_builtin_memalign=s.asm.Ca).apply(null,arguments)},$e=s.stackSave=function(){return($e=s.stackSave=s.asm.Da).apply(null,arguments)},Je=s.stackRestore=function(){return(Je=s.stackRestore=s.asm.Ea).apply(null,arguments)},ye=s.stackAlloc=function(){return(ye=s.stackAlloc=s.asm.Fa).apply(null,arguments)};s.UTF8ToString=U,s.stackAlloc=ye,s.stackSave=$e,s.stackRestore=Je,s.cwrap=function(e,t,r,i){r=r||[];var a=r.every(h=>h==="number"||h==="boolean");return t!=="string"&&a&&!i?s["_"+e]:function(){return zs(e,t,r,arguments)}};var vt;Ne=function e(){vt||hr(),vt||(Ne=e)};function hr(){function e(){if(!vt&&(vt=!0,s.calledRun=!0,!An)){if(s.noFSInit||sr||(sr=!0,rr(),s.stdin=s.stdin,s.stdout=s.stdout,s.stderr=s.stderr,s.stdin?Ge("stdin",s.stdin):Gt("/dev/tty","/dev/stdin"),s.stdout?Ge("stdout",null,s.stdout):Gt("/dev/tty","/dev/stdout"),s.stderr?Ge("stderr",null,s.stderr):Gt("/dev/tty1","/dev/stderr"),Le("/dev/stdin",0),Le("/dev/stdout",1),Le("/dev/stderr",1)),Kn=!1,Pt(zn),s.onRuntimeInitialized&&s.onRuntimeInitialized(),s.postRun)for(typeof s.postRun=="function"&&(s.postRun=[s.postRun]);s.postRun.length;){var t=s.postRun.shift();On.unshift(t)}Pt(On)}}if(!(0<_e)){if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)js();Pt(Cn),0<_e||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),e()},1)):e())}}if(s.preInit)for(typeof s.preInit=="function"&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();return hr(),d}),St)};typeof exports=="object"&&typeof He=="object"?(He.exports=Ze,He.exports.default=Ze):typeof define=="function"&&define.amd?define([],function(){return Ze}):typeof exports=="object"&&(exports.Module=Ze);var He;const Qo=new URL(""+new URL("sql-wasm-18fc45ef.wasm",import.meta.url).href,self.location).toString();let sn;async function Vo(){return sn||(sn=Ze({locateFile:()=>Qo})),await sn}class Te{constructor(l){this.SQL=l}static _instance;static async getInstance(){return Te._instance||(Te._instance=new Te(await Vo())),Te._instance}hasTable(l,c){return l.exec('SELECT name FROM sqlite_master WHERE type="table"')[0].values.map(p=>p[0]).includes(c)}extractQmAndroidDbKeys(l){let c=null;try{if(c=new this.SQL.Database(new Uint8Array(l)),!this.hasTable(c,"audio_file_ekey_table"))return null;const d=c.exec("select file_path, ekey from audio_file_ekey_table");return d.length===0?[]:d[0].values.map(([s,j])=>({name:hs(String(s)),ekey:String(j)}))}finally{c?.close()}}}function Mt(o,l=8){return"0x"+(o|0).toString(16).padStart(l,"0")}class lt{constructor(l){this.view=l;const c=l.getUint32(0,!0);this.length=4+c,this.readInt()}offset=4;length;toString(){const l=Mt(this.offset,8),c=Mt(this.length,8);return`<MMKVParser offset=${l} len=${c}>`}get eof(){return this.offset>=this.length}readByte(){return this.view.getUint8(this.offset++)}readBigInt(){let l=0n,c=0n,d;do d=this.readByte(),l|=BigInt(d&127)<<c,c+=7n;while(d&128);return l}readInt(){const l=this.readBigInt();if(l>Number.MAX_SAFE_INTEGER)throw new Error("Runtime Error: BigInt too large to cast as number");return Number(l)}readBytes(l){const c=this.offset,d=c+l;return this.offset=d,new Uint8Array(this.view.buffer.slice(c,d))}readString(){const l=this.readInt(),c=this.readBytes(l);return fn(c).normalize()}readVariantString(){const l=this.readInt(),c=this.offset+l,d=this.readString();if(c!==this.offset){const p=Mt(c),s=Mt(this.offset);throw new Error(`readVariantString failed: offset does mismatch (expect: ${p}, actual: ${s})`)}return d}skipContainer(){const l=this.readInt();this.offset+=l}static toStringMap(l){const c=new lt(l),d=new Map;for(;!c.eof;){const p=c.readString(),s=c.readVariantString();d.set(p,s)}return d}static parseKuwoEKey(l){const c=new lt(l),d=[];for(;!c.eof;){const s=c.readString().match(/^sec_ekey#(\d+)-(.+)/);if(!s){c.skipContainer();continue}const[j,S,b]=s,M=c.readVariantString();d.push({rid:S,quality:b,ekey:M})}return d}}const qr={hljs:{display:"block",overflowX:"auto",padding:"0.5em",color:"#333",background:"#f8f8f8"},"hljs-comment":{color:"#998",fontStyle:"italic"},"hljs-quote":{color:"#998",fontStyle:"italic"},"hljs-keyword":{color:"#333",fontWeight:"bold"},"hljs-selector-tag":{color:"#333",fontWeight:"bold"},"hljs-subst":{color:"#333",fontWeight:"normal"},"hljs-number":{color:"#008080"},"hljs-literal":{color:"#008080"},"hljs-variable":{color:"#008080"},"hljs-template-variable":{color:"#008080"},"hljs-tag .hljs-attr":{color:"#008080"},"hljs-string":{color:"#d14"},"hljs-doctag":{color:"#d14"},"hljs-title":{color:"#900",fontWeight:"bold"},"hljs-section":{color:"#900",fontWeight:"bold"},"hljs-selector-id":{color:"#900",fontWeight:"bold"},"hljs-type":{color:"#458",fontWeight:"bold"},"hljs-class .hljs-title":{color:"#458",fontWeight:"bold"},"hljs-tag":{color:"#000080",fontWeight:"normal"},"hljs-name":{color:"#000080",fontWeight:"normal"},"hljs-attribute":{color:"#000080",fontWeight:"normal"},"hljs-regexp":{color:"#009926"},"hljs-link":{color:"#009926"},"hljs-symbol":{color:"#990073"},"hljs-bullet":{color:"#990073"},"hljs-built_in":{color:"#0086b3"},"hljs-builtin-name":{color:"#0086b3"},"hljs-meta":{color:"#999",fontWeight:"bold"},"hljs-deletion":{background:"#fdd"},"hljs-addition":{background:"#dfd"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}},$o=`try {
  $gz_b64 = adb shell su -c "cat '{{ dir }}/{{ file }}' | gzip | base64" | Out-String
  $bStream = New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String($gz_b64))
  $decoded = New-Object System.IO.Compression.GzipStream($bStream, [System.IO.Compression.CompressionMode]::Decompress)
  $outFile = New-Object System.IO.FileStream("\${PWD}\\{{ file }}", [System.IO.FileMode]::Create, [System.IO.FileAccess]::Write)
  $decoded.CopyTo($outFile)
} catch {
  Write-Host "遇到错误:"
  Write-Host $_
} finally {
  if ($outFile -ne $null) { $outFile.Dispose() }
  if ($decoded -ne $null) { $decoded.Dispose() }
  if ($bStream -ne $null) { $bStream.Dispose() }
}
`,Jo=`sh adb shell su -c "cat '{{ dir }}/{{ file }}' | gzip | base64" \\
    | base64 -d | gzip -d '{{ file }}'
`,Ar=(o,l)=>o.replace(/\{\{\s*(\w+)\s*\}\}/g,(c,d)=>Object.hasOwn(l,d)?String(l[d]):"<nil>");function fs({dir:o,file:l}){const c=Ar($o,{dir:o,file:l}),d=Ar(Jo,{dir:o,file:l});return n.jsxs(n.Fragment,{children:[n.jsxs(y,{children:["你需要 ",n.jsx("code",{children:"root"})," 访问权限来访问安卓应用的私有数据。"]}),n.jsxs(y,{children:["⚠️ 请注意，获取 ",n.jsx("code",{children:"root"})," 通常意味着你的安卓设备",n.jsx(J.span,{color:"red.400",children:"将失去保修资格"}),"。"]}),n.jsxs(Nr,{allowToggle:!0,mt:"2",children:[n.jsxs(tt,{children:[n.jsx(V,{as:"h3",size:"md",children:n.jsxs(nt,{children:[n.jsx(N,{as:"span",flex:"1",textAlign:"left",children:"在安卓手机端操作"}),n.jsx(rt,{})]})}),n.jsx(st,{pb:4,children:n.jsxs(Ae,{children:[n.jsx(E,{children:n.jsxs(y,{children:["启动具有 ",n.jsx(K,{children:"root"})," 特权的文件浏览器"]})}),n.jsx(E,{children:n.jsxs(y,{children:["访问 ",n.jsxs(K,{children:[o,"/"]})," 目录。"]})}),n.jsx(E,{children:n.jsxs(y,{children:["将文件 ",n.jsx(K,{children:l})," 复制到浏览器可访问的目录。",n.jsx("br",{}),"（例如下载目录）"]})}),n.jsx(E,{children:n.jsx(y,{children:"提交该数据库文件。"})})]})})]}),n.jsxs(tt,{children:[n.jsx(V,{as:"h3",size:"md",children:n.jsxs(nt,{children:[n.jsx(N,{as:"span",flex:"1",textAlign:"left",children:"在 PC 端操作（ADB / PowerShell）"}),n.jsx(rt,{})]})}),n.jsx(st,{pb:4,children:n.jsxs(Ae,{children:[n.jsxs(E,{children:[n.jsxs(y,{children:["确保 ",n.jsx("code",{children:"adb"})," 命令可用。"]}),n.jsxs(y,{children:["💡 如果没有，可以",n.jsxs(qe,{href:"https://scoop.sh/#/apps?q=adb",isExternal:!0,children:["使用 Scoop 安装 ",n.jsx($r,{})]}),"。"]})]}),n.jsx(E,{children:n.jsx(y,{children:"启动终端并进入 PowerShell 7 环境。"})}),n.jsx(E,{children:n.jsx(y,{children:"将安卓设备连接到电脑，并允许调试。"})}),n.jsxs(E,{children:[n.jsx(y,{children:"粘贴执行下述代码。若设备提示「超级用户请求」请允许："}),n.jsx(At,{language:"ps1",style:qr,children:c})]}),n.jsx(E,{children:n.jsxs(y,{children:["提交当前目录下的 ",n.jsx(K,{children:l})," 文件。"]})})]})})]}),n.jsxs(tt,{children:[n.jsx(V,{as:"h3",size:"md",children:n.jsxs(nt,{children:[n.jsx(N,{as:"span",flex:"1",textAlign:"left",children:"在 Linux / Mac 系统下操作（ADB / Shell）"}),n.jsx(rt,{})]})}),n.jsx(st,{pb:4,children:n.jsxs(Ae,{children:[n.jsx(E,{children:n.jsx(y,{children:"将安卓设备连接到电脑，并允许调试。"})}),n.jsxs(E,{children:[n.jsx(y,{children:"粘贴执行下述代码。若设备提示「超级用户请求」请允许："}),n.jsx(At,{language:"bash",style:qr,children:d})]}),n.jsx(E,{children:n.jsxs(y,{children:["提交当前目录下的 ",n.jsx(K,{children:l})," 文件。"]})})]})})]})]})]})}const Yo=""+new URL("iosAllowBackup-5be73a8d.webp",import.meta.url).href;function xn({children:o}){return n.jsx(y,{as:"pre",whiteSpace:"pre-wrap",wordBreak:"break-all",children:n.jsx(K,{children:o})})}const Xo="0011wjLv1bIkvv",Ir="333407709-0011wjLv1bIkvv-1.mgalaxy",on="Q0M00011wjLv1bIkvv.mflac";function Er({jailbreak:o}){const l=o,c=!o,d=o?"/var/mobile/Containers/Data/Application/<随机>/":"/AppDomain-";return n.jsxs(n.Fragment,{children:[n.jsx(V,{as:"h3",size:"md",children:"获取密钥数据库文件"}),n.jsxs(Ae,{children:[c&&n.jsxs(E,{children:[n.jsx(y,{children:"首先需要在 iOS 客户端的设定允许备份："}),n.jsx(Tr,{src:Yo})]}),c&&n.jsx(E,{children:n.jsx(y,{children:"使用你喜欢的备份软件对 iOS 设备进行完整备份；"})}),n.jsxs(E,{children:[c&&n.jsx(y,{children:"打开备份文件，并导航到下述目录："}),l&&n.jsx(y,{children:"访问下述目录："}),n.jsxs(xn,{children:[d,"com.tencent.QQMusic/Documents/mmkv/"]})]}),n.jsx(E,{children:n.jsxs(y,{children:["提取或导出密钥数据库文件 ",n.jsx(K,{children:"filenameEkeyMap"}),"；"]})}),n.jsx(E,{children:n.jsxs(y,{children:["提交导出的 ",n.jsx(K,{children:"filenameEkeyMap"})," 文件；"]})}),n.jsx(E,{children:n.jsx(y,{children:"按下「保存」来应用更改。"})})]}),n.jsx(V,{as:"h3",size:"md",mt:"3",children:"获取离线文件"}),n.jsxs(N,{children:[n.jsx(y,{children:"访问下述目录："}),n.jsxs(xn,{children:[d,"com.tencent.QQMusic/Library/Application Support/com.tencent.QQMusic/iData/iMusic"]}),n.jsxs(y,{children:["该目录又存在数个子目录，其子目录下保存的「",n.jsx(K,{children:"[字符].m[字符]"}),"」文件则是最终的加密文件。"]}),n.jsxs(y,{children:["格式：",n.jsx(K,{children:"[song_id]-[mid]-[随机数字].m[后缀]"})]}),n.jsxs(y,{children:["　例：",n.jsx(K,{children:Ir})]})]}),n.jsx(V,{as:"h3",size:"md",mt:"3",children:"解密离线文件"}),n.jsx(y,{children:"勾选设定界面的「使用近似文件名匹配」可跳过该节内容。"}),n.jsx(y,{children:"⚠ 注意：若密钥过多，匹配过程可能会造成浏览器卡顿或无响应。"}),n.jsxs(Ae,{children:[n.jsx(E,{children:n.jsxs(y,{children:["提取文件的 ",n.jsx(K,{children:"[mid]"})," 部分，如 ",n.jsx(K,{children:Xo}),"；"]})}),n.jsx(E,{children:n.jsxs(y,{children:["查找密钥表，得到文件名「",n.jsx(K,{children:on}),"」；"]})}),n.jsx(E,{children:n.jsxs(y,{children:["将文件更名为对应的文件名，如",n.jsx(K,{display:"inline",children:Ir})," ➔",n.jsx(K,{display:"inline",children:on}),"；"]})}),n.jsx(E,{children:n.jsxs(y,{children:["回到主界面，提交文件「",n.jsx(K,{children:on}),"」。"]})})]})]})}function Zo(){return n.jsxs(n.Fragment,{children:[n.jsxs(N,{children:[n.jsx(y,{children:"iOS 设备获取应用私有文件比较麻烦，你需要越狱或使用一台 PC 或 Mac 来对 iOS 设备进行完整备份。"}),n.jsx(y,{children:"因此，建议换用 PC 或 Mac 重新下载音乐文件然后再尝试解密。"})]}),n.jsxs(Nr,{allowToggle:!0,mt:"2",children:[n.jsxs(tt,{children:[n.jsx(V,{as:"h3",size:"md",children:n.jsxs(nt,{children:[n.jsx(N,{as:"span",flex:"1",textAlign:"left",children:"我的 iOS 设备已经越狱"}),n.jsx(rt,{})]})}),n.jsx(st,{pb:4,children:n.jsx(Er,{jailbreak:!0})})]}),n.jsxs(tt,{children:[n.jsx(V,{as:"h3",size:"md",children:n.jsxs(nt,{children:[n.jsx(N,{as:"span",flex:"1",textAlign:"left",children:"我的 iOS 设备没有越狱"}),n.jsx(rt,{})]})}),n.jsx(st,{pb:4,children:n.jsx(Er,{jailbreak:!1})})]})]})]})}function ea(o){return Y({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3.5 2A1.5 1.5 0 0 1 5 3.5V5H3.5a1.5 1.5 0 1 1 0-3zM6 5V3.5A2.5 2.5 0 1 0 3.5 6H5v4H3.5A2.5 2.5 0 1 0 6 12.5V11h4v1.5a2.5 2.5 0 1 0 2.5-2.5H11V6h1.5A2.5 2.5 0 1 0 10 3.5V5H6zm4 1v4H6V6h4zm1-1V3.5A1.5 1.5 0 1 1 12.5 5H11zm0 6h1.5a1.5 1.5 0 1 1-1.5 1.5V11zm-6 0v1.5A1.5 1.5 0 1 1 3.5 11H5z"}}]})(o)}function ta(o){return Y({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M7.27 2.047a1 1 0 0 1 1.46 0l6.345 6.77c.6.638.146 1.683-.73 1.683H11.5v3a1 1 0 0 1-1 1h-5a1 1 0 0 1-1-1v-3H1.654C.78 10.5.326 9.455.924 8.816L7.27 2.047zM14.346 9.5 8 2.731 1.654 9.5H4.5a1 1 0 0 1 1 1v3h5v-3a1 1 0 0 1 1-1h2.846z"}}]})(o)}function na(){return n.jsxs("ruby",{children:[n.jsx(yn,{children:n.jsx(W,{as:ea})}),n.jsx("rp",{children:" ("}),n.jsx("rt",{children:"command"}),n.jsx("rp",{children:")"})]})}function ra(){return n.jsxs("ruby",{children:[n.jsx(yn,{children:n.jsx(W,{as:ta})}),n.jsx("rp",{children:" ("}),n.jsx("rt",{children:"shift"}),n.jsx("rp",{children:")"})]})}function sa(){return n.jsxs(n.Fragment,{children:[n.jsx(y,{children:"Mac 客户端使用 mmkv 数据库储存密钥。"}),n.jsx(y,{children:"该密钥文件通常存储在下述路径："}),n.jsx(xn,{children:"~/Library/Containers/com.tencent.QQMusicMac/Data/Library/Application Support/QQMusicMac/mmkv/MMKVStreamEncryptId"}),n.jsx(V,{as:"h3",size:"md",mt:"4",children:"导入密钥"}),n.jsxs(Ae,{children:[n.jsx(E,{children:n.jsxs(y,{children:["选中并复制上述的 ",n.jsx(K,{children:"MMKVStreamEncryptId"})," 文件路径"]})}),n.jsx(E,{children:n.jsx(y,{children:"点击上方的「文件选择区域」，打开「文件选择框」"})}),n.jsx(E,{children:n.jsxs(y,{children:["按下「",n.jsx(ra,{})," + ",n.jsx(na,{})," + ",n.jsx(yn,{children:"G"}),"」组合键打开「路径输入框」"]})}),n.jsx(E,{children:n.jsxs(y,{children:["粘贴之前复制的 ",n.jsx(K,{children:"MMKVStreamEncryptId"})," 文件路径"]})}),n.jsx(E,{children:n.jsx(y,{children:"按下「回车键」确认。"})})]})]})}function ia(){return n.jsx(n.Fragment,{children:n.jsx(y,{children:"使用 Windows 客户端下载的文件不需要导入密钥。"})})}function ms(){return n.jsxs(n.Fragment,{children:[n.jsxs(Ct,{children:[n.jsx(oe,{children:"安卓"}),n.jsx(oe,{children:"iOS"}),n.jsx(oe,{children:"Mac"}),n.jsx(oe,{children:"Windows"})]}),n.jsxs(zt,{flex:1,overflow:"auto",children:[n.jsx(ae,{children:n.jsx(fs,{dir:"/data/data/com.tencent.qqmusic/databases",file:"player_process_db"})}),n.jsx(ae,{children:n.jsx(Zo,{})}),n.jsx(ae,{children:n.jsx(sa,{})}),n.jsx(ae,{children:n.jsx(ia,{})})]})]})}function oa(){const o=gn(),l=vn(),{keys:c,allowFuzzyNameSearch:d}=_n(lo),[p,s]=le.useState(!1),j=()=>l(zo()),S=()=>l(Lo()),b=A=>{l(Ho({enable:A.target.checked}))},M=async A=>{try{const C=await A.arrayBuffer();let R=null;if(/[_.]db$/i.test(A.name)){if(R=(await Te.getInstance()).extractQmAndroidDbKeys(C),!R){alert(`不是支持的 SQLite 数据库文件。
表名：${R}`);return}}else if(/MMKVStreamEncryptId|filenameEkeyMap/i.test(A.name)){const X=await A.arrayBuffer(),be=lt.toStringMap(new DataView(X));R=Array.from(be.entries(),([Ce,ze])=>({name:hs(Ce),ekey:ze}))}R?.length===0?o({title:"未导入密钥",description:"选择的密钥数据库文件未发现任何可用的密钥。",isClosable:!0,status:"warning"}):R?(l(To(R)),s(!1),o({title:`导入成功 (${R.length})`,description:"记得保存更改来应用。",isClosable:!0,status:"success"})):alert(`不支持的文件：${A.name}`)}catch(C){console.error("error during import: ",C),alert(`导入数据库时发生错误：${C}`)}};return n.jsxs(G,{minH:0,flexDir:"column",flex:1,children:[n.jsx(V,{as:"h2",size:"lg",children:"QMCv2 解密密钥"}),n.jsx(y,{children:"QQ 音乐目前采用的加密方案（QMCv2）。在使用「QQ 音乐」安卓、Mac 或 iOS 客户端的情况下，其「离线加密文件」对应的「密钥」储存在独立的数据库文件内。"}),n.jsxs(Ie,{pb:2,pt:2,children:[n.jsxs(Br,{isAttached:!0,colorScheme:"purple",variant:"outline",children:[n.jsx(je,{onClick:j,leftIcon:n.jsx(W,{as:es}),children:"添加一条密钥"}),n.jsxs(jn,{children:[n.jsx(bn,{as:Fe,icon:n.jsx(Rt,{})}),n.jsxs(wn,{children:[n.jsx(ot,{onClick:()=>s(!0),icon:n.jsx(W,{as:kn,boxSize:5}),children:"从文件导入密钥…"}),n.jsx(Ur,{}),n.jsx(ot,{color:"red",onClick:S,icon:n.jsx(W,{as:Yr,boxSize:5}),children:"清空密钥"})]})]})]}),n.jsxs(Ie,{children:[n.jsx(gi,{isChecked:d,onChange:b,children:n.jsx(y,{children:"匹配相似文件名"})}),n.jsx(Wr,{hasArrow:!0,closeOnClick:!1,label:n.jsxs(N,{children:[n.jsx(y,{children:"若文件名匹配失败，则使用相似文件名的密钥。"}),n.jsxs(y,{children:["使用「",n.jsxs("ruby",{children:["莱文斯坦距离",n.jsx("rp",{children:" ("}),n.jsx("rt",{children:"Levenshtein distance"}),n.jsx("rp",{children:")"})]}),"」算法计算相似程度。"]}),n.jsx(y,{children:"若密钥数量过多，匹配时可能会造成浏览器卡顿或无响应一段时间。"}),n.jsx(y,{children:"若不确定，请勾选该项。"})]}),children:n.jsx(Jr,{})})]})]}),n.jsxs(N,{flex:1,minH:0,overflow:"auto",pr:"4",children:[n.jsx(Ot,{spacing:3,children:c.map(({id:A,ekey:C,name:R},X)=>n.jsx(Go,{id:A,ekey:C,name:R,i:X},A))}),c.length===0&&n.jsx(y,{children:"还没有添加密钥。"})]}),n.jsx(ds,{clientName:"QQ 音乐",show:p,onClose:()=>s(!1),onImport:M,children:n.jsx(ms,{})})]})}const aa=le.memo(({id:o,ekey:l,quality:c,rid:d,i:p})=>{const s=ct(),j=(b,M)=>s(Fo({id:o,field:b,value:M.target.value})),S=()=>s(Po({id:o}));return n.jsx(E,{mt:0,pt:2,pb:2,_even:{bg:"gray.50"},children:n.jsxs(Ie,{children:[n.jsx(y,{w:"2em",textAlign:"center",children:p+1}),n.jsxs(Ee,{flex:1,children:[n.jsxs(Ie,{flex:1,w:"full",children:[n.jsx(et,{variant:"flushed",placeholder:"资源 ID",value:d,onChange:b=>j("rid",b),type:"number",maxW:"8em"}),n.jsx(et,{variant:"flushed",placeholder:"音质格式",value:c,onChange:b=>j("quality",b),flex:1})]}),n.jsxs(Fr,{size:"xs",children:[n.jsx(Pr,{pr:"2",children:n.jsx(W,{as:Zr})}),n.jsx(et,{variant:"flushed",placeholder:"密钥，通常包含 364 或 704 位字符，没有空格。",value:l,onChange:b=>j("ekey",b)}),n.jsx(Kr,{children:n.jsx(y,{pl:"2",color:l.length?"green.500":"red.500",children:n.jsx("code",{children:l.length||"?"})})})]})]}),n.jsx(Fe,{"aria-label":"删除该密钥",icon:n.jsx(W,{as:Xr,boxSize:6}),variant:"ghost",colorScheme:"red",type:"button",onClick:S})]})})});function la(){return n.jsx(n.Fragment,{children:n.jsx(y,{children:"使用 Windows 客户端下载的文件不需要导入密钥。"})})}function ps(){return n.jsxs(n.Fragment,{children:[n.jsxs(Ct,{children:[n.jsx(oe,{children:"安卓"}),n.jsx(oe,{children:"Windows"})]}),n.jsxs(zt,{flex:1,overflow:"auto",children:[n.jsx(ae,{children:n.jsx(fs,{dir:"/data/data/cn.kuwo.player/files/mmkv",file:"cn.kuwo.player.mmkv.defaultconfig"})}),n.jsx(ae,{children:n.jsx(la,{})})]})]})}function ca(){const o=gn(),l=vn(),c=_n(uo),[d,p]=le.useState(!1),s=()=>l(Do()),j=()=>l(Ko()),S=async b=>{let M=null;if(/cn\.kuwo\.player\.mmkv/i.test(b.name)){const A=await b.arrayBuffer();M=lt.parseKuwoEKey(new DataView(A))}M?.length===0?o({title:"未导入密钥",description:"选择的密钥数据库文件未发现任何可用的密钥。",isClosable:!0,status:"warning"}):M?(l(No(M)),p(!1),o({title:`导入完成，共导入了 ${M.length} 个密钥。`,description:"记得按下「保存」来应用。",isClosable:!0,status:"success"})):o({title:`不支持的文件：${b.name}`,isClosable:!0,status:"error"})};return n.jsxs(G,{minH:0,flexDir:"column",flex:1,children:[n.jsx(V,{as:"h2",size:"lg",children:"酷我解密密钥（KwmV2）"}),n.jsxs(y,{children:["酷我安卓版本的「臻品音质」已经换用 V2 版，后缀名为 ",n.jsx(K,{children:"mflac"})," 或沿用旧的 ",n.jsx(K,{children:"kwm"}),"。","","该格式需要提取密钥后才能正常解密。"]}),n.jsx(Ie,{pb:2,pt:2,children:n.jsxs(Br,{isAttached:!0,colorScheme:"purple",variant:"outline",children:[n.jsx(je,{onClick:s,leftIcon:n.jsx(W,{as:es}),children:"添加一条密钥"}),n.jsxs(jn,{children:[n.jsx(bn,{as:Fe,icon:n.jsx(Rt,{})}),n.jsxs(wn,{children:[n.jsx(ot,{onClick:()=>p(!0),icon:n.jsx(W,{as:kn,boxSize:5}),children:"从文件导入密钥…"}),n.jsx(Ur,{}),n.jsx(ot,{color:"red",onClick:j,icon:n.jsx(W,{as:Yr,boxSize:5}),children:"清空密钥"})]})]})]})}),n.jsxs(N,{flex:1,minH:0,overflow:"auto",pr:"4",children:[n.jsx(Ot,{spacing:3,children:c.map(({id:b,ekey:M,quality:A,rid:C},R)=>n.jsx(aa,{id:b,ekey:M,quality:A,rid:C,i:R},b))}),c.length===0&&n.jsx(y,{children:"还没有添加密钥。"})]}),n.jsx(ds,{clientName:"酷我音乐",show:d,onClose:()=>p(!1),onImport:S,children:n.jsx(ps,{})})]})}const qt=[{name:"QMCv2 密钥",Tab:oa},{name:"KWMv2 密钥",Tab:ca},{name:"其它／待定",Tab:()=>n.jsx(y,{children:"这里空空如也～"})}];function ua(){const o=gn(),l=ct(),c=Gr({base:!1,lg:!0})??!1,[d,p]=le.useState(0),s=M=>{p(M)},j=()=>{l(Uo()),o({status:"info",title:"未储存的设定已舍弃",description:"已还原到更改前的状态。",isClosable:!0})},S=()=>{l(Bo()),o({status:"success",title:"设定已应用",isClosable:!0})},b=ts(ao);return n.jsxs(G,{flexDir:"column",flex:1,children:[n.jsxs(jn,{children:[n.jsx(bn,{as:je,leftIcon:n.jsx(Bi,{}),rightIcon:n.jsx(Rt,{}),colorScheme:"gray",variant:"outline",w:"full",flexShrink:0,hidden:c,mb:"4",children:qt[d].name}),n.jsx(ji,{children:n.jsx(wn,{w:"100px",children:qt.map(({name:M},A)=>n.jsx(ot,{onClick:()=>p(A),children:M},M))})})]}),n.jsxs(Et,{orientation:c?"vertical":"horizontal",align:"start",variant:"line-i",display:"flex",flex:1,index:d,onChange:s,children:[n.jsx(Ct,{hidden:!c,minW:"8em",width:"8em",textAlign:"right",justifyContent:"center",children:qt.map(({name:M})=>n.jsx(oe,{children:M},M))}),n.jsx(zt,{children:qt.map(({name:M,Tab:A})=>n.jsxs(G,{as:ae,flex:1,flexDir:"column",h:"100%",children:[n.jsx(G,{h:"100%",flex:1,minH:0,children:n.jsx(A,{})}),n.jsx(Ee,{mt:"4",alignItems:"flex-start",w:"full",children:n.jsxs(G,{flexDir:"row",gap:"2",w:"full",children:[n.jsx(It,{children:b?n.jsxs(N,{color:"gray",children:["有未储存的更改"," ",n.jsx(J.span,{color:"red",wordBreak:"keep-all",children:"设定将在保存后生效"})]}):n.jsx(N,{color:"gray",children:"设定将在保存后生效"})}),n.jsx(bi,{}),n.jsxs(Ie,{gap:"2",justifyContent:"flex-end",children:[n.jsx(Fe,{icon:n.jsx(W,{as:Ui}),onClick:j,colorScheme:"red",variant:"ghost",title:"放弃未储存的更改，将设定还原为储存前的状态。","aria-label":"放弃未储存的更改"}),n.jsx(je,{onClick:S,children:"保存"})]})]})})]},M))})]})]})}function da(){const o=Gr({base:{p:"0"},lg:{p:void 0}});return n.jsx(at,{as:G,maxW:"container.lg",...o,children:n.jsx(ua,{})})}function T(o,l={}){let c=!1;function d(){if(!c){c=!0;return}throw new Error("[anatomy] .part(...) should only be called once. Did you mean to use .extend(...) ?")}function p(...A){d();for(const C of A)l[C]=b(C);return T(o,l)}function s(...A){for(const C of A)C in l||(l[C]=b(C));return T(o,l)}function j(){return Object.fromEntries(Object.entries(l).map(([C,R])=>[C,R.selector]))}function S(){return Object.fromEntries(Object.entries(l).map(([C,R])=>[C,R.className]))}function b(A){const X=`chakra-${(["container","root"].includes(A??"")?[o]:[o,A]).filter(Boolean).join("__")}`;return{className:X,selector:`.${X}`,toString:()=>A}}return{parts:p,toPart:b,extend:s,selectors:j,classnames:S,get keys(){return Object.keys(l)},__type:{}}}T("accordion").parts("root","container","button","panel").extend("icon");T("alert").parts("title","description","container").extend("icon","spinner");T("avatar").parts("label","badge","container").extend("excessLabel","group");T("breadcrumb").parts("link","item","container").extend("separator");T("button").parts();T("checkbox").parts("control","icon","container").extend("label");T("progress").parts("track","filledTrack").extend("label");T("drawer").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer");T("editable").parts("preview","input","textarea");T("form").parts("container","requiredIndicator","helperText");T("formError").parts("text","icon");T("input").parts("addon","field","element");T("list").parts("container","item","icon");T("menu").parts("button","list","item").extend("groupTitle","command","divider");T("modal").parts("overlay","dialogContainer","dialog").extend("header","closeButton","body","footer");T("numberinput").parts("root","field","stepperGroup","stepper");T("pininput").parts("field");T("popover").parts("content","header","body","footer").extend("popper","arrow","closeButton");T("progress").parts("label","filledTrack","track");T("radio").parts("container","control","label");T("select").parts("field","icon");T("slider").parts("container","track","thumb","filledTrack","mark");T("stat").parts("container","label","helpText","number","icon");T("switch").parts("container","track","thumb");T("table").parts("table","thead","tbody","tr","th","td","tfoot","caption");var ha=T("tabs").parts("root","tab","tablist","tabpanel","tabpanels","indicator");T("tag").parts("container","label","closeButton");T("card").parts("container","header","body","footer");const an=Qr("tabs-color"),ln=Qr("tabs-bg"),{definePartsStyle:fa,defineMultiStyleConfig:ma}=wi(ha.keys),pa=fa(o=>{const{colorScheme:l,orientation:c}=o,d=c==="vertical",p=d?"borderEnd":"borderTop",s=d?"marginEnd":"marginTop";return{tablist:{[p]:"2px solid",borderColor:"inherit"},tabpanels:{flex:1,minH:0},tabpanel:{padding:0},tab:{[p]:"2px solid",borderColor:"transparent",[s]:"-2px",justifyContent:"flex-end",_selected:{[an.variable]:`colors.${l}.600`,_dark:{[an.variable]:`colors.${l}.300`},borderColor:"currentColor"},_active:{[ln.variable]:"colors.gray.200",_dark:{[ln.variable]:"colors.whiteAlpha.300"}},_disabled:{_active:{bg:"none"}},color:an.reference,bg:ln.reference},root:{display:"flex",flexDir:d?"row":"column",gap:8,minH:0}}}),xa=ma({baseStyle:{tablist:{userSelect:"none"},tabpanel:{minHeight:0,overflow:"auto",maxHeight:"100%"}},variants:{"line-i":pa}}),ya=vi({fonts:{body:["-system-ui,-apple-system,BlinkMacSystemFont","Source Han Sans CN,Noto Sans CJK SC","Segoe UI,Helvetica,Arial,sans-serif","Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol"].join(",")},components:{Button:{baseStyle:{fontWeight:"normal"},defaultProps:{colorScheme:"teal"}},Tabs:xa,Link:{baseStyle:{color:"blue.600"}}},styles:{global:{"#root":{minHeight:"100vh",maxHeight:"100vh",display:"flex",flexDirection:"column"}}},sizes:{footer:{container:"5rem",content:"4rem"}}}),Xe=(...o)=>{},ga={log:Xe,info:Xe,warn:Xe,debug:Xe,trace:Xe};function Cr(){return{}.ENABLE_PERF_LOG==="1"?window.console:ga}const ja="um-react-settings";function ba(o){return Hi(Mn.getInitialState().production,l=>{if(o?.qmc2){const{allowFuzzyNameSearch:c,keys:d}=o.qmc2;for(const[p,s]of _r(d))typeof s=="string"&&(l.qmc2.keys[p]=s);typeof c=="boolean"&&(l.qmc2.allowFuzzyNameSearch=c)}if(o?.kwm2){const{keys:c}=o.kwm2;for(const[d,p]of _r(c))typeof p=="string"&&os(d)&&(l.kwm2.keys[d]=p)}})}function wa(o,l=ja){let c;try{const d=JSON.parse(localStorage.getItem(l)??"");if(d){const p=ba(d);o.dispatch(Co(p)),Cr().debug("settings loaded")}}catch{}return o.subscribe(Ti({delay:150},()=>{const d=o.getState().settings.production;c!==d&&(c=d,localStorage.setItem(l,JSON.stringify(d)),Cr().debug("settings saved"))}))}const va=Ii({fileListing:jo,settings:Wo}),_a=o=>Ei({reducer:va,preloadedState:o}),ka=async()=>ss.request(Sn.VERSION,null);function Sa(){const o=Ci(ka,[]);return n.jsx(G,{as:"span",pl:"1",alignItems:"center","data-testid":"sdk-version",children:n.jsx(Wr,{hasArrow:!0,placement:"top",label:n.jsxs(Ee,{children:[n.jsx(y,{children:"App: 0.2.0-0bd5215"}),n.jsxs(y,{children:["SDK: ",o]})]}),bg:"gray.300",color:"black",children:n.jsx(Jr,{})})})}const Ma=30*60*1e3,zr=()=>new Date().getFullYear();function qa(){const[o,l]=le.useState(zr);return le.useEffect(()=>{const c=()=>l(zr);c();const d=setInterval(c,Ma);return()=>{clearInterval(d)}},[]),n.jsx(n.Fragment,{children:o})}function Aa(){return n.jsxs(It,{fontSize:"sm",textAlign:"center",bottom:"0",w:"full",pt:"3",pb:"3",borderTop:"1px solid",borderColor:"gray.300",bg:"gray.100",color:"gray.800",flexDir:"column",flexShrink:0,children:[n.jsxs(G,{as:y,children:[n.jsx(qe,{href:"https://git.unlock-music.dev/um/um-react",isExternal:!0,children:"音乐解锁"})," (0.2.0",n.jsx(le.Suspense,{children:n.jsx(Sa,{})}),") - 移除已购音乐的加密保护。"]}),n.jsxs(y,{children:["© 2019 - ",n.jsx(qa,{})," ",n.jsx(qe,{href:"https://git.unlock-music.dev/um",isExternal:!0,children:"UnlockMusic 团队"})," | ",n.jsx(qe,{href:"https://git.unlock-music.dev/um/um-react/src/branch/main/LICENSE",isExternal:!0,children:"使用 MIT 授权协议"})]})]})}function cn({children:o,className:l,id:c}){return n.jsx(V,{as:"h3",id:c,className:l,pt:3,pb:1,borderBottom:"1px solid",borderColor:"gray.300",color:"gray.800",size:"lg",children:o})}function it({children:o,className:l,id:c}){return n.jsx(V,{as:"h4",id:c,className:l,pt:3,pb:1,color:"gray.700",size:"md",children:o})}const Or=_i({pointerEvents:"none",userSelect:"none"});function De({children:o}){return n.jsxs(n.Fragment,{children:[n.jsx(J.span,{css:Or,children:"「"}),o,n.jsx(J.span,{css:Or,children:"」"})]})}function xs(){return n.jsxs(n.Fragment,{children:[n.jsx(y,{children:n.jsx(J.strong,{children:"1、请检查您的文件"})}),n.jsx(y,{children:"尝试用下载音乐的设备播放一次看看，如果官方客户端都无法播放，那解锁肯定会失败哦。"})]})}function ys({children:o}){return n.jsx(ki,{bg:"orange.100",borderRadius:5,px:2,mx:1,children:o})}function Ia(){return n.jsxs(n.Fragment,{children:["点击顶部的",n.jsx(De,{children:"设置"})]})}function Ea(){return n.jsxs(G,{as:"span",alignItems:"center",flexWrap:"wrap",children:["按下",n.jsx(De,{children:"添加一条密钥"}),"按钮",n.jsx(ys,{children:"右侧"}),"的",n.jsx(Fe,{colorScheme:"purple",variant:"outline",size:"sm",icon:n.jsx(Rt,{}),ml:"2",borderTopLeftRadius:0,borderBottomLeftRadius:0,isDisabled:!0,css:{":disabled":{opacity:1}},"aria-label":"示例按钮"})]})}function gs({clientInstructions:o,tab:l}){return n.jsxs(n.Fragment,{children:[n.jsx(y,{children:"导入密钥可以参考下面的步骤："}),n.jsxs(Ae,{children:[n.jsx(E,{children:n.jsx(Ia,{})}),n.jsxs(E,{children:["设定区域选择",n.jsx(De,{children:l})]}),n.jsx(E,{children:n.jsx(Ea,{})}),n.jsx(E,{children:n.jsxs(G,{flexDir:"row",alignItems:"center",children:["选择 ",n.jsxs(De,{children:[n.jsx(W,{as:kn,boxSize:5,mr:2})," 从文件导入密钥…"]})]})}),n.jsxs(E,{children:[n.jsx(y,{children:"选择你的客户端平台来查看密钥提取说明："}),n.jsx(Et,{display:"flex",flexDir:"column",border:"1px solid",borderColor:"gray.300",borderRadius:5,children:o})]})]})]})}function Ca(){return n.jsxs(n.Fragment,{children:[n.jsx(it,{children:"解锁失败"}),n.jsxs(Ot,{spacing:2,children:[n.jsx(E,{children:n.jsx(xs,{})}),n.jsxs(E,{children:[n.jsx(y,{children:n.jsx(J.strong,{children:"2、检查您的平台"})}),n.jsxs(y,{children:["日前，仅",n.jsx(ys,{children:"手机客户端"}),"下载的",n.jsx(De,{children:n.jsx("strong",{children:"至臻全景声"})}),"及",n.jsx(De,{children:n.jsx("strong",{children:"至臻母带"})}),"音质的音乐文件采用新版加密。"]}),n.jsx(y,{children:"其他音质目前不需要提取密钥。"}),n.jsx(y,{children:"PC平台暂未推出使用新版加密的音质。"}),n.jsx(at,{p:2,children:n.jsxs(un,{status:"warning",borderRadius:5,children:[n.jsx(dn,{}),n.jsxs(G,{flexDir:"column",children:[n.jsx(y,{children:"安卓用户提取密钥需要 root 权限，或注入文件提供器。"}),n.jsx(y,{children:"请注意：项目组不提倡使用第三方修改版应用亦不会提供，使用前请自行评估风险。"})]})]})}),n.jsx(gs,{tab:"KWMv2 密钥",clientInstructions:n.jsx(ps,{})})]})]})]})}function Rr({id:o,title:l}){return n.jsxs(qe,{isExternal:!0,target:"_blank",href:`https://git.unlock-music.dev/um/um-react/issues/${o}`,children:[`#${o}`,l&&` - ${l}`]})}function za(){return n.jsxs(n.Fragment,{children:[n.jsx(it,{children:"解密后没有封面等信息"}),n.jsx(y,{children:"该项目进行解密处理。如果加密前的资源没有内嵌元信息或封面，解密的文件也没有。"}),n.jsx(y,{children:"请使用第三方工具进行编辑或管理元信息。"}),n.jsx(it,{children:"如何批量下载"}),n.jsxs(y,{children:["暂时没有实现，不过你可以在 ",n.jsx(Rr,{id:34,title:"[UI] 全部下载功能"})," 以及"," ",n.jsx(Rr,{id:43,title:"批量下载"})," 追踪该问题。"]}),n.jsx(it,{children:"有更多问题？"}),n.jsxs(y,{children:["欢迎进入 ",n.jsxs(qe,{href:"https://t.me/unlock_music_chat",isExternal:!0,children:["Telegram “音乐解锁-交流” 交流群",n.jsx($r,{})]})," 一起探讨。"]})]})}function Oa(){return n.jsxs(n.Fragment,{children:[n.jsx(it,{children:"解锁失败"}),n.jsxs(Ot,{spacing:2,children:[n.jsx(E,{children:n.jsx(xs,{})}),n.jsxs(E,{children:[n.jsx(y,{children:n.jsx(J.strong,{children:"2、检查您的平台"})}),n.jsx(y,{children:"日前，仅Windows客户端下载的歌曲无需密钥，其余平台的官方正式版本均需要提取密钥。"}),n.jsx(at,{p:2,children:n.jsxs(un,{status:"warning",borderRadius:5,children:[n.jsx(dn,{}),n.jsxs(G,{flexDir:"column",children:[n.jsx(y,{children:"iOS 用户提取歌曲困难，建议换用电脑操作；"}),n.jsx(y,{children:"安卓用户提取密钥需要root，也建议用电脑操作。"})]})]})}),n.jsx(at,{p:2,pt:0,children:n.jsxs(un,{status:"info",borderRadius:5,children:[n.jsx(dn,{}),"重复下载同一首的歌曲不重复扣下载配额，但是同一首歌的两个版本会重复扣下载配额，请仔细分辨。"]})}),n.jsx(gs,{tab:"QMCv2 密钥",clientInstructions:n.jsx(ms,{})})]})]})]})}function Ra(){return n.jsxs(at,{pb:10,maxW:"container.md",children:[n.jsx(It,{children:n.jsx(V,{as:"h2",children:"常见问题解答"})}),n.jsx(cn,{children:"QQ 音乐"}),n.jsx(Oa,{}),n.jsx(cn,{children:"酷我音乐"}),n.jsx(Ca,{}),n.jsx(cn,{children:"其它问题"}),n.jsx(za,{})]})}const Lr=_a();function La(){return le.useEffect(()=>wa(Lr),[]),n.jsx(Si,{theme:ya,children:n.jsxs(zi,{store:Lr,children:[n.jsxs(Et,{flex:1,minH:0,display:"flex",flexDir:"column",children:[n.jsxs(Ct,{justifyContent:"center",children:[n.jsxs(oe,{children:[n.jsx(W,{as:Pi,mr:"1"}),n.jsx(J.span,{children:"应用"})]}),n.jsxs(oe,{children:[n.jsx(W,{as:Ni,mr:"1"}),n.jsx(J.span,{children:"设置"})]}),n.jsxs(oe,{children:[n.jsx(W,{as:Ki,mr:"1"}),n.jsx(J.span,{children:"问答"})]})]}),n.jsxs(zt,{overflow:"auto",minW:0,flexDir:"column",flex:1,display:"flex",children:[n.jsx(ae,{children:n.jsx(Io,{})}),n.jsx(ae,{flex:1,display:"flex",children:n.jsx(da,{})}),n.jsx(ae,{children:n.jsx(Ra,{})})]})]}),n.jsx(Aa,{})]})})}At.registerLanguage("ps1",Di);At.registerLanguage("bash",Fi);hn.createRoot(document.getElementById("root")).render(n.jsx(Oi.StrictMode,{children:n.jsx(La,{})}));
